!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("node-fetch")):"function"==typeof define&&define.amd?define(["node-fetch"],t):"object"==typeof exports?exports.GeoRaster=t(require("node-fetch")):e.GeoRaster=t(e["node-fetch"])}("undefined"!=typeof self?self:this,(function(e){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){parcelRequire=function(t,i,n,o){var s,a="function"==typeof parcelRequire&&parcelRequire;function l(e,n){if(!i[e]){if(!t[e]){var o="function"==typeof parcelRequire&&parcelRequire;if(!n&&o)return o(e,!0);if(a)return a(e,!0);if("string"==typeof e)return r(8)(e);var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}f.resolve=function(r){return t[e][1][r]||r},f.cache={};var c=i[e]=new l.Module(e);t[e][0].call(c.exports,f,c,c.exports,this)}return i[e].exports;function f(e){return l(f.resolve(e))}}l.isParcelRequire=!0,l.Module=function(e){this.id=e,this.bundle=l,this.exports={}},l.modules=t,l.cache=i,l.parent=a,l.register=function(e,r){t[e]=[function(e,t){t.exports=r},{}]};for(var c=0;c<n.length;c++)try{l(n[c])}catch(t){s||(s=t)}if(n.length){var f=l(n[n.length-1]);e.exports=f}if(parcelRequire=l,s)throw s;return l}({j27V:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.geoKeys=r.geoKeyNames=r.ExtraSamplesValues=r.photometricInterpretations=r.fieldTypes=r.fieldTypeNames=r.arrayFields=r.fieldTagTypes=r.fieldTags=r.fieldTagNames=void 0;const i={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams"};r.fieldTagNames=i;const n={};r.fieldTags=n;for(const e in i)i.hasOwnProperty(e)&&(n[i[e]]=parseInt(e,10));r.fieldTagTypes={256:"SHORT",257:"SHORT",258:"SHORT",259:"SHORT",262:"SHORT",273:"LONG",274:"SHORT",277:"SHORT",278:"LONG",279:"LONG",282:"RATIONAL",283:"RATIONAL",284:"SHORT",286:"SHORT",287:"RATIONAL",296:"SHORT",305:"ASCII",306:"ASCII",338:"SHORT",339:"SHORT",513:"LONG",514:"LONG",1024:"SHORT",1025:"SHORT",2048:"SHORT",2049:"ASCII",33550:"DOUBLE",33922:"DOUBLE",34665:"LONG",34735:"SHORT",34737:"ASCII",42113:"ASCII"};const o=[n.BitsPerSample,n.ExtraSamples,n.SampleFormat,n.StripByteCounts,n.StripOffsets,n.StripRowCounts,n.TileByteCounts,n.TileOffsets];r.arrayFields=o;const s={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"};r.fieldTypeNames=s;const a={};r.fieldTypes=a;for(const e in s)s.hasOwnProperty(e)&&(a[s[e]]=parseInt(e,10));r.photometricInterpretations={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9};r.ExtraSamplesValues={Unspecified:0,Assocalpha:1,Unassalpha:2};const l={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"};r.geoKeyNames=l;const c={};r.geoKeys=c;for(const e in l)l.hasOwnProperty(e)&&(c[l[e]]=parseInt(e,10))},{}],fpBl:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fromWhiteIsZero=function(e,t){const{width:r,height:i}=e,n=new Uint8Array(r*i*3);let o;for(let r=0,i=0;r<e.length;++r,i+=3)o=256-e[r]/t*256,n[i]=o,n[i+1]=o,n[i+2]=o;return n},r.fromBlackIsZero=function(e,t){const{width:r,height:i}=e,n=new Uint8Array(r*i*3);let o;for(let r=0,i=0;r<e.length;++r,i+=3)o=e[r]/t*256,n[i]=o,n[i+1]=o,n[i+2]=o;return n},r.fromPalette=function(e,t){const{width:r,height:i}=e,n=new Uint8Array(r*i*3),o=t.length/3,s=t.length/3*2;for(let r=0,i=0;r<e.length;++r,i+=3){const a=e[r];n[i]=t[a]/65536*256,n[i+1]=t[a+o]/65536*256,n[i+2]=t[a+s]/65536*256}return n},r.fromCMYK=function(e){const{width:t,height:r}=e,i=new Uint8Array(t*r*3);for(let t=0,r=0;t<e.length;t+=4,r+=3){const n=e[t],o=e[t+1],s=e[t+2],a=e[t+3];i[r]=(255-n)/256*255*((255-a)/256),i[r+1]=(255-o)/256*255*((255-a)/256),i[r+2]=(255-s)/256*255*((255-a)/256)}return i},r.fromYCbCr=function(e){const{width:t,height:r}=e,i=new Uint8ClampedArray(t*r*3);for(let t=0,r=0;t<e.length;t+=3,r+=3){const n=e[t],o=e[t+1],s=e[t+2];i[r]=n+1.402*(s-128),i[r+1]=n-.34414*(o-128)-.71414*(s-128),i[r+2]=n+1.772*(o-128)}return i},r.fromCIELab=function(e){const{width:t,height:r}=e,i=new Uint8Array(t*r*3);for(let t=0,r=0;t<e.length;t+=3,r+=3){let n,o,s,a=(e[t+0]+16)/116,l=(e[t+1]<<24>>24)/500+a,c=a-(e[t+2]<<24>>24)/200;n=(n=3.2406*(l=.95047*(l*l*l>.008856?l*l*l:(l-16/116)/7.787))+-1.5372*(a=1*(a*a*a>.008856?a*a*a:(a-16/116)/7.787))+-.4986*(c=1.08883*(c*c*c>.008856?c*c*c:(c-16/116)/7.787)))>.0031308?1.055*n**(1/2.4)-.055:12.92*n,o=(o=-.9689*l+1.8758*a+.0415*c)>.0031308?1.055*o**(1/2.4)-.055:12.92*o,s=(s=.0557*l+-.204*a+1.057*c)>.0031308?1.055*s**(1/2.4)-.055:12.92*s,i[r]=255*Math.max(0,Math.min(1,n)),i[r+1]=255*Math.max(0,Math.min(1,o)),i[r+2]=255*Math.max(0,Math.min(1,s))}return i}},{}],IKSA:[function(e,t,r){"use strict";function i(e,t){let r=e.length-t,i=0;do{for(let r=t;r>0;r--)e[i+t]+=e[i],i++;r-=t}while(r>0)}function n(e,t,r){let i=0,n=e.length;const o=n/r;for(;n>t;){for(let r=t;r>0;--r)e[i+t]+=e[i],++i;n-=t}const s=e.slice();for(let t=0;t<o;++t)for(let i=0;i<r;++i)e[r*t+i]=s[(r-i-1)*o+t]}Object.defineProperty(r,"__esModule",{value:!0}),r.applyPredictor=function(e,t,r,o,s,a){if(!t||1===t)return e;for(let e=0;e<s.length;++e){if(s[e]%8!=0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(s[e]!==s[0])throw new Error("When decoding with predictor, all samples must have the same size.")}const l=s[0]/8,c=2===a?1:s.length;for(let a=0;a<o&&!(a*c*r*l>=e.byteLength);++a){let o;if(2===t){switch(s[0]){case 8:o=new Uint8Array(e,a*c*r*l,c*r*l);break;case 16:o=new Uint16Array(e,a*c*r*l,c*r*l/2);break;case 32:o=new Uint32Array(e,a*c*r*l,c*r*l/4);break;default:throw new Error(`Predictor 2 not allowed with ${s[0]} bits per sample.`)}i(o,c)}else 3===t&&n(o=new Uint8Array(e,a*c*r*l,c*r*l),c,l)}return e}},{}],FJDe:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("../predictor");r.default=class{decode(e,t){const r=this.decodeBlock(t),n=e.Predictor||1;if(1!==n){const t=!e.StripOffsets,o=t?e.TileWidth:e.ImageWidth,s=t?e.TileLength:e.RowsPerStrip||e.ImageLength;return(0,i.applyPredictor)(r,n,o,s,e.BitsPerSample,e.PlanarConfiguration)}return r}}},{"../predictor":"IKSA"}],V9bQ:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));class n extends i.default{decodeBlock(e){return e}}r.default=n},{"./basedecoder":"FJDe"}],tcId:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));function n(e,t){for(let r=t.length-1;r>=0;r--)e.push(t[r]);return e}function o(e){const t=new Uint16Array(4093),r=new Uint8Array(4093);for(let e=0;e<=257;e++)t[e]=4096,r[e]=e;let i=258,o=9,s=0;function a(){i=258,o=9}function l(e){const t=function(e,t,r){const i=t%8,n=Math.floor(t/8),o=8-i,s=t+r-8*(n+1);let a=8*(n+2)-(t+r);const l=8*(n+2)-t;if(a=Math.max(0,a),n>=e.length)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),257;let c=e[n]&2**(8-i)-1,f=c<<=r-o;if(n+1<e.length){let t=e[n+1]>>>a;f+=t<<=Math.max(0,r-l)}if(s>8&&n+2<e.length){const i=8*(n+3)-(t+r);f+=e[n+2]>>>i}return f}(e,s,o);return s+=o,t}function c(e,n){return r[i]=n,t[i]=e,++i-1}function f(e){const i=[];for(let n=e;4096!==n;n=t[n])i.push(r[n]);return i}const u=[];a();const h=new Uint8Array(e);let d,p=l(h);for(;257!==p;){if(256===p){for(a(),p=l(h);256===p;)p=l(h);if(257===p)break;if(p>256)throw new Error("corrupted code at scanline "+p);n(u,f(p)),d=p}else if(p<i){const e=f(p);n(u,e),c(d,e[e.length-1]),d=p}else{const e=f(d);if(!e)throw new Error(`Bogus entry. Not in dictionary, ${d} / ${i}, position: ${s}`);n(u,e),u.push(e[e.length-1]),c(d,e[e.length-1]),d=p}i+1>=2**o&&(12===o?d=void 0:o++),p=l(h)}return new Uint8Array(u)}class s extends i.default{decodeBlock(e){return o(e).buffer}}r.default=s},{"./basedecoder":"FJDe"}],J7kk:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));const n=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),o=4017,s=799,a=3406,l=2276,c=1567,f=3784,u=5793,h=2896;function d(e,t){let r=0;const i=[];let n=16;for(;n>0&&!e[n-1];)--n;i.push({children:[],index:0});let o,s=i[0];for(let a=0;a<n;a++){for(let n=0;n<e[a];n++){for((s=i.pop()).children[s.index]=t[r];s.index>0;)s=i.pop();for(s.index++,i.push(s);i.length<=a;)i.push(o={children:[],index:0}),s.children[s.index]=o.children,s=o;r++}a+1<n&&(i.push(o={children:[],index:0}),s.children[s.index]=o.children,s=o)}return i[0].children}function p(e,t,r,i,o,s,a,l,c){const{mcusPerLine:f,progressive:u}=r,h=t;let d=t,p=0,g=0;function y(){if(g>0)return p>>--g&1;if(255===(p=e[d++])){const t=e[d++];if(t)throw new Error("unexpected marker: "+(p<<8|t).toString(16))}return g=7,p>>>7}function m(e){let t,r=e;for(;null!==(t=y());){if("number"==typeof(r=r[t]))return r;if("object"!=typeof r)throw new Error("invalid huffman sequence")}return null}function w(e){let t=e,r=0;for(;t>0;){const e=y();if(null===e)return;r=r<<1|e,--t}return r}function b(e){const t=w(e);return t>=1<<e-1?t:t+(-1<<e)+1}let T,S=0,P=0;function I(e,t,r,i,n){const o=r%f,s=(r/f|0)*e.v+i,a=o*e.h+n;t(e,e.blocks[s][a])}function A(e,t,r){const i=r/e.blocksPerLine|0,n=r%e.blocksPerLine;t(e,e.blocks[i][n])}const D=i.length;let O,v,M,G,_,E;E=u?0===s?0===l?function(e,t){const r=m(e.huffmanTableDC),i=0===r?0:b(r)<<c;e.pred+=i,t[0]=e.pred}:function(e,t){t[0]|=y()<<c}:0===l?function(e,t){if(S>0)return void S--;let r=s;const i=a;for(;r<=i;){const i=m(e.huffmanTableAC),o=15&i,s=i>>4;if(0===o){if(s<15){S=w(s)+(1<<s)-1;break}r+=16}else t[n[r+=s]]=b(o)*(1<<c),r++}}:function(e,t){let r=s;const i=a;let o=0;for(;r<=i;){const i=n[r],s=t[i]<0?-1:1;switch(P){case 0:{const t=m(e.huffmanTableAC),r=15&t;if(o=t>>4,0===r)o<15?(S=w(o)+(1<<o),P=4):(o=16,P=1);else{if(1!==r)throw new Error("invalid ACn encoding");T=b(r),P=o?2:3}continue}case 1:case 2:t[i]?t[i]+=(y()<<c)*s:0==--o&&(P=2===P?3:0);break;case 3:t[i]?t[i]+=(y()<<c)*s:(t[i]=T<<c,P=0);break;case 4:t[i]&&(t[i]+=(y()<<c)*s)}r++}4===P&&0==--S&&(P=0)}:function(e,t){const r=m(e.huffmanTableDC),i=0===r?0:b(r);e.pred+=i,t[0]=e.pred;let o=1;for(;o<64;){const r=m(e.huffmanTableAC),i=15&r,s=r>>4;if(0===i){if(s<15)break;o+=16}else t[n[o+=s]]=b(i),o++}};let k,C,F=0;C=1===D?i[0].blocksPerLine*i[0].blocksPerColumn:f*r.mcusPerColumn;const U=o||C;for(;F<C;){for(v=0;v<D;v++)i[v].pred=0;if(S=0,1===D)for(O=i[0],_=0;_<U;_++)A(O,E,F),F++;else for(_=0;_<U;_++){for(v=0;v<D;v++){O=i[v];const{h:e,v:t}=O;for(M=0;M<t;M++)for(G=0;G<e;G++)I(O,E,F,M,G)}if(++F===C)break}if(g=0,(k=e[d]<<8|e[d+1])<65280)throw new Error("marker was not found");if(!(k>=65488&&k<=65495))break;d+=2}return d-h}function g(e,t){const r=[],{blocksPerLine:i,blocksPerColumn:n}=t,d=i<<3,p=new Int32Array(64),g=new Uint8Array(64);function y(e,r,i){const n=t.quantizationTable;let d,p,g,y,m,w,b,T,S;const P=i;let I;for(I=0;I<64;I++)P[I]=e[I]*n[I];for(I=0;I<8;++I){const e=8*I;0!==P[1+e]||0!==P[2+e]||0!==P[3+e]||0!==P[4+e]||0!==P[5+e]||0!==P[6+e]||0!==P[7+e]?(d=u*P[0+e]+128>>8,p=u*P[4+e]+128>>8,g=P[2+e],y=P[6+e],m=h*(P[1+e]-P[7+e])+128>>8,T=h*(P[1+e]+P[7+e])+128>>8,w=P[3+e]<<4,b=P[5+e]<<4,S=d-p+1>>1,d=d+p+1>>1,p=S,S=g*f+y*c+128>>8,g=g*c-y*f+128>>8,y=S,S=m-b+1>>1,m=m+b+1>>1,b=S,S=T+w+1>>1,w=T-w+1>>1,T=S,S=d-y+1>>1,d=d+y+1>>1,y=S,S=p-g+1>>1,p=p+g+1>>1,g=S,S=m*l+T*a+2048>>12,m=m*a-T*l+2048>>12,T=S,S=w*s+b*o+2048>>12,w=w*o-b*s+2048>>12,b=S,P[0+e]=d+T,P[7+e]=d-T,P[1+e]=p+b,P[6+e]=p-b,P[2+e]=g+w,P[5+e]=g-w,P[3+e]=y+m,P[4+e]=y-m):(S=u*P[0+e]+512>>10,P[0+e]=S,P[1+e]=S,P[2+e]=S,P[3+e]=S,P[4+e]=S,P[5+e]=S,P[6+e]=S,P[7+e]=S)}for(I=0;I<8;++I){const e=I;0!==P[8+e]||0!==P[16+e]||0!==P[24+e]||0!==P[32+e]||0!==P[40+e]||0!==P[48+e]||0!==P[56+e]?(d=u*P[0+e]+2048>>12,p=u*P[32+e]+2048>>12,g=P[16+e],y=P[48+e],m=h*(P[8+e]-P[56+e])+2048>>12,T=h*(P[8+e]+P[56+e])+2048>>12,w=P[24+e],b=P[40+e],S=d-p+1>>1,d=d+p+1>>1,p=S,S=g*f+y*c+2048>>12,g=g*c-y*f+2048>>12,y=S,S=m-b+1>>1,m=m+b+1>>1,b=S,S=T+w+1>>1,w=T-w+1>>1,T=S,S=d-y+1>>1,d=d+y+1>>1,y=S,S=p-g+1>>1,p=p+g+1>>1,g=S,S=m*l+T*a+2048>>12,m=m*a-T*l+2048>>12,T=S,S=w*s+b*o+2048>>12,w=w*o-b*s+2048>>12,b=S,P[0+e]=d+T,P[56+e]=d-T,P[8+e]=p+b,P[48+e]=p-b,P[16+e]=g+w,P[40+e]=g-w,P[24+e]=y+m,P[32+e]=y-m):(S=u*i[I+0]+8192>>14,P[0+e]=S,P[8+e]=S,P[16+e]=S,P[24+e]=S,P[32+e]=S,P[40+e]=S,P[48+e]=S,P[56+e]=S)}for(I=0;I<64;++I){const e=128+(P[I]+8>>4);r[I]=e<0?0:e>255?255:e}}for(let e=0;e<n;e++){const n=e<<3;for(let e=0;e<8;e++)r.push(new Uint8Array(d));for(let o=0;o<i;o++){y(t.blocks[e][o],g,p);let i=0;const s=o<<3;for(let e=0;e<8;e++){const t=r[n+e];for(let e=0;e<8;e++)t[s+e]=g[i++]}}}return r}class y{constructor(){this.jfif=null,this.adobe=null,this.quantizationTables=[],this.huffmanTablesAC=[],this.huffmanTablesDC=[],this.resetFrames()}resetFrames(){this.frames=[]}parse(e){let t=0;function r(){const r=e[t]<<8|e[t+1];return t+=2,r}function i(){const i=r(),n=e.subarray(t,t+i-2);return t+=n.length,n}function o(e){let t,r,i=0,n=0;for(r in e.components)e.components.hasOwnProperty(r)&&(i<(t=e.components[r]).h&&(i=t.h),n<t.v&&(n=t.v));const o=Math.ceil(e.samplesPerLine/8/i),s=Math.ceil(e.scanLines/8/n);for(r in e.components)if(e.components.hasOwnProperty(r)){t=e.components[r];const a=Math.ceil(Math.ceil(e.samplesPerLine/8)*t.h/i),l=Math.ceil(Math.ceil(e.scanLines/8)*t.v/n),c=o*t.h,f=s*t.v,u=[];for(let e=0;e<f;e++){const e=[];for(let t=0;t<c;t++)e.push(new Int32Array(64));u.push(e)}t.blocksPerLine=a,t.blocksPerColumn=l,t.blocks=u}e.maxH=i,e.maxV=n,e.mcusPerLine=o,e.mcusPerColumn=s}let s=r();if(65496!==s)throw new Error("SOI not found");for(s=r();65497!==s;){switch(s){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:{const e=i();65504===s&&74===e[0]&&70===e[1]&&73===e[2]&&70===e[3]&&0===e[4]&&(this.jfif={version:{major:e[5],minor:e[6]},densityUnits:e[7],xDensity:e[8]<<8|e[9],yDensity:e[10]<<8|e[11],thumbWidth:e[12],thumbHeight:e[13],thumbData:e.subarray(14,14+3*e[12]*e[13])}),65518===s&&65===e[0]&&100===e[1]&&111===e[2]&&98===e[3]&&101===e[4]&&0===e[5]&&(this.adobe={version:e[6],flags0:e[7]<<8|e[8],flags1:e[9]<<8|e[10],transformCode:e[11]});break}case 65499:{const i=r()+t-2;for(;t<i;){const i=e[t++],o=new Int32Array(64);if(i>>4==0)for(let r=0;r<64;r++)o[n[r]]=e[t++];else{if(i>>4!=1)throw new Error("DQT: invalid table spec");for(let e=0;e<64;e++)o[n[e]]=r()}this.quantizationTables[15&i]=o}break}case 65472:case 65473:case 65474:{r();const i={extended:65473===s,progressive:65474===s,precision:e[t++],scanLines:r(),samplesPerLine:r(),components:{},componentsOrder:[]},n=e[t++];let a;for(let r=0;r<n;r++){a=e[t];const r=e[t+1]>>4,n=15&e[t+1],o=e[t+2];i.componentsOrder.push(a),i.components[a]={h:r,v:n,quantizationIdx:o},t+=3}o(i),this.frames.push(i);break}case 65476:{const i=r();for(let r=2;r<i;){const i=e[t++],n=new Uint8Array(16);let o=0;for(let r=0;r<16;r++,t++)n[r]=e[t],o+=n[r];const s=new Uint8Array(o);for(let r=0;r<o;r++,t++)s[r]=e[t];r+=17+o,i>>4==0?this.huffmanTablesDC[15&i]=d(n,s):this.huffmanTablesAC[15&i]=d(n,s)}break}case 65501:r(),this.resetInterval=r();break;case 65498:{r();const i=e[t++],n=[],o=this.frames[0];for(let r=0;r<i;r++){const r=o.components[e[t++]],i=e[t++];r.huffmanTableDC=this.huffmanTablesDC[i>>4],r.huffmanTableAC=this.huffmanTablesAC[15&i],n.push(r)}const s=e[t++],a=e[t++],l=e[t++],c=p(e,t,o,n,this.resetInterval,s,a,l>>4,15&l);t+=c;break}case 65535:255!==e[t]&&t--;break;default:if(255===e[t-3]&&e[t-2]>=192&&e[t-2]<=254){t-=3;break}throw new Error("unknown JPEG marker "+s.toString(16))}s=r()}}getResult(){const{frames:e}=this;if(0===this.frames.length)throw new Error("no frames were decoded");this.frames.length>1&&console.warn("more than one frame is not supported");for(let e=0;e<this.frames.length;e++){const t=this.frames[e].components;for(const e of Object.keys(t))t[e].quantizationTable=this.quantizationTables[t[e].quantizationIdx],delete t[e].quantizationIdx}const t=e[0],{components:r,componentsOrder:i}=t,n=[],o=t.samplesPerLine,s=t.scanLines;for(let e=0;e<i.length;e++){const o=r[i[e]];n.push({lines:g(0,o),scaleX:o.h/t.maxH,scaleY:o.v/t.maxV})}const a=new Uint8Array(o*s*n.length);let l=0;for(let e=0;e<s;++e)for(let t=0;t<o;++t)for(let r=0;r<n.length;++r){const i=n[r];a[l]=i.lines[0|e*i.scaleY][0|t*i.scaleX],++l}return a}}class m extends i.default{constructor(e){super(),this.reader=new y,e.JPEGTables&&this.reader.parse(e.JPEGTables)}decodeBlock(e){return this.reader.resetFrames(),this.reader.parse(new Uint8Array(e)),this.reader.getResult().buffer}}r.default=m},{"./basedecoder":"FJDe"}],JAiC:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("pako/lib/inflate"),n=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));class o extends n.default{decodeBlock(e){return(0,i.inflate)(new Uint8Array(e)).buffer}}r.default=o},{"./basedecoder":"FJDe"}],OcPz:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));class n extends i.default{decodeBlock(e){const t=new DataView(e),r=[];for(let i=0;i<e.byteLength;++i){let e=t.getInt8(i);if(e<0){const n=t.getUint8(i+1);e=-e;for(let t=0;t<=e;++t)r.push(n);i+=1}else{for(let n=0;n<=e;++n)r.push(t.getUint8(i+n+1));i+=e+1}}return new Uint8Array(r).buffer}}r.default=n},{"./basedecoder":"FJDe"}],FGCZ:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getDecoder=function(e){switch(e.Compression){case void 0:case 1:return new i.default;case 5:return new n.default;case 6:throw new Error("old style JPEG compression is not supported.");case 7:return new o.default(e);case 8:case 32946:return new s.default;case 32773:return new a.default;default:throw new Error("Unknown compression method identifier: "+e.Compression)}};var i=l(e("./raw")),n=l(e("./lzw")),o=l(e("./jpeg")),s=l(e("./deflate")),a=l(e("./packbits"));function l(e){return e&&e.__esModule?e:{default:e}}},{"./raw":"V9bQ","./lzw":"tcId","./jpeg":"J7kk","./deflate":"JAiC","./packbits":"OcPz"}],OQju:[function(e,t,r){"use strict";function i(e,t,r,i=1){return new(Object.getPrototypeOf(e).constructor)(t*r*i)}function n(e,t,r,n,o){const s=t/n,a=r/o;return e.map(e=>{const l=i(e,n,o);for(let i=0;i<o;++i){const o=Math.min(Math.round(a*i),r-1);for(let r=0;r<n;++r){const a=Math.min(Math.round(s*r),t-1),c=e[o*t+a];l[i*n+r]=c}}return l})}function o(e,t,r){return(1-r)*e+r*t}function s(e,t,r,n,s){const a=t/n,l=r/s;return e.map(e=>{const c=i(e,n,s);for(let i=0;i<s;++i){const s=l*i,f=Math.floor(s),u=Math.min(Math.ceil(s),r-1);for(let r=0;r<n;++r){const l=a*r,h=l%1,d=Math.floor(l),p=Math.min(Math.ceil(l),t-1),g=e[f*t+d],y=e[f*t+p],m=e[u*t+d],w=e[u*t+p],b=o(o(g,y,h),o(m,w,h),s%1);c[i*n+r]=b}}return c})}function a(e,t,r,n,o,s){const a=t/n,l=r/o,c=i(e,n,o,s);for(let i=0;i<o;++i){const o=Math.min(Math.round(l*i),r-1);for(let r=0;r<n;++r){const l=Math.min(Math.round(a*r),t-1);for(let a=0;a<s;++a){const f=e[o*t*s+l*s+a];c[i*n*s+r*s+a]=f}}}return c}function l(e,t,r,n,s,a){const l=t/n,c=r/s,f=i(e,n,s,a);for(let i=0;i<s;++i){const s=c*i,u=Math.floor(s),h=Math.min(Math.ceil(s),r-1);for(let r=0;r<n;++r){const c=l*r,d=c%1,p=Math.floor(c),g=Math.min(Math.ceil(c),t-1);for(let l=0;l<a;++l){const c=e[u*t*a+p*a+l],y=e[u*t*a+g*a+l],m=e[h*t*a+p*a+l],w=e[h*t*a+g*a+l],b=o(o(c,y,d),o(m,w,d),s%1);f[i*n*a+r*a+l]=b}}}return f}Object.defineProperty(r,"__esModule",{value:!0}),r.resampleNearest=n,r.resampleBilinear=s,r.resample=function(e,t,r,i,o,a="nearest"){switch(a.toLowerCase()){case"nearest":return n(e,t,r,i,o);case"bilinear":case"linear":return s(e,t,r,i,o);default:throw new Error(`Unsupported resampling method: '${a}'`)}},r.resampleNearestInterleaved=a,r.resampleBilinearInterleaved=l,r.resampleInterleaved=function(e,t,r,i,n,o,s="nearest"){switch(s.toLowerCase()){case"nearest":return a(e,t,r,i,n,o);case"bilinear":case"linear":return l(e,t,r,i,n,o);default:throw new Error(`Unsupported resampling method: '${s}'`)}}},{}],eOWo:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("txml")),n=e("./globals"),o=e("./rgb"),s=e("./compression"),a=e("./resample");function l(e,t,r){let i=0;for(let n=t;n<r;++n)i+=e[n];return i}function c(e,t,r){switch(e){case 1:switch(t){case 8:return new Uint8Array(r);case 16:return new Uint16Array(r);case 32:return new Uint32Array(r)}break;case 2:switch(t){case 8:return new Int8Array(r);case 16:return new Int16Array(r);case 32:return new Int32Array(r)}break;case 3:switch(t){case 32:return new Float32Array(r);case 64:return new Float64Array(r)}}throw Error("Unsupported data format/bitsPerSample")}var f=class{constructor(e,t,r,i,n,o){this.fileDirectory=e,this.geoKeys=t,this.dataView=r,this.littleEndian=i,this.tiles=n?{}:null,this.isTiled=!e.StripOffsets;const s=e.PlanarConfiguration;if(this.planarConfiguration=void 0===s?1:s,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.");this.source=o}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return this.fileDirectory.SamplesPerPixel}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:void 0!==this.fileDirectory.RowsPerStrip?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBytesPerPixel(){let e=0;for(let t=0;t<this.fileDirectory.BitsPerSample.length;++t){const r=this.fileDirectory.BitsPerSample[t];if(r%8!=0)throw new Error(`Sample bit-width of ${r} is not supported.`);if(r!==this.fileDirectory.BitsPerSample[0])throw new Error("Differing size of samples in a pixel are not supported.");e+=r}return e/8}getSampleByteSize(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${e} is out of range.`);const t=this.fileDirectory.BitsPerSample[e];if(t%8!=0)throw new Error(`Sample bit-width of ${t} is not supported.`);return t/8}getReaderForSample(e){const t=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,r=this.fileDirectory.BitsPerSample[e];switch(t){case 1:switch(r){case 8:return DataView.prototype.getUint8;case 16:return DataView.prototype.getUint16;case 32:return DataView.prototype.getUint32}break;case 2:switch(r){case 8:return DataView.prototype.getInt8;case 16:return DataView.prototype.getInt16;case 32:return DataView.prototype.getInt32}break;case 3:switch(r){case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}throw Error("Unsupported data format/bitsPerSample")}getArrayForSample(e,t){return c(this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,this.fileDirectory.BitsPerSample[e],t)}async getTileOrStrip(e,t,r,i){const n=Math.ceil(this.getWidth()/this.getTileWidth()),o=Math.ceil(this.getHeight()/this.getTileHeight());let s;const{tiles:a}=this;let l,c;1===this.planarConfiguration?s=t*n+e:2===this.planarConfiguration&&(s=r*n*o+t*n+e),this.isTiled?(l=this.fileDirectory.TileOffsets[s],c=this.fileDirectory.TileByteCounts[s]):(l=this.fileDirectory.StripOffsets[s],c=this.fileDirectory.StripByteCounts[s]);const f=await this.source.fetch(l,c);let u;return null===a?u=i.decode(this.fileDirectory,f):a[s]||(u=i.decode(this.fileDirectory,f),a[s]=u),{x:e,y:t,sample:r,data:await u}}async _readRaster(e,t,r,i,n,o,s,c){const f=this.getTileWidth(),u=this.getTileHeight(),h=Math.max(Math.floor(e[0]/f),0),d=Math.min(Math.ceil(e[2]/f),Math.ceil(this.getWidth()/this.getTileWidth())),p=Math.max(Math.floor(e[1]/u),0),g=Math.min(Math.ceil(e[3]/u),Math.ceil(this.getHeight()/this.getTileHeight())),y=e[2]-e[0];let m=this.getBytesPerPixel();const w=[],b=[];for(let e=0;e<t.length;++e)1===this.planarConfiguration?w.push(l(this.fileDirectory.BitsPerSample,0,t[e])/8):w.push(0),b.push(this.getReaderForSample(t[e]));const T=[],{littleEndian:S}=this;for(let o=p;o<g;++o)for(let s=h;s<d;++s)for(let a=0;a<t.length;++a){const l=a,c=t[a];2===this.planarConfiguration&&(m=this.getSampleByteSize(c));const h=this.getTileOrStrip(s,o,c,n);T.push(h),h.then(n=>{const o=n.data,s=new DataView(o),a=n.y*u,c=n.x*f,h=(n.y+1)*u,d=(n.x+1)*f,p=b[l],g=Math.min(u,u-(h-e[3])),T=Math.min(f,f-(d-e[2]));for(let n=Math.max(0,e[1]-a);n<g;++n)for(let o=Math.max(0,e[0]-c);o<T;++o){const u=(n*f+o)*m,h=p.call(s,u+w[l],S);let d;i?(d=(n+a-e[1])*y*t.length+(o+c-e[0])*t.length+l,r[d]=h):(d=(n+a-e[1])*y+o+c-e[0],r[l][d]=h)}})}if(await Promise.all(T),o&&e[2]-e[0]!==o||s&&e[3]-e[1]!==s){let n;return(n=i?(0,a.resampleInterleaved)(r,e[2]-e[0],e[3]-e[1],o,s,t.length,c):(0,a.resample)(r,e[2]-e[0],e[3]-e[1],o,s,c)).width=o,n.height=s,n}return r.width=o||e[2]-e[0],r.height=s||e[3]-e[1],r}async readRasters({window:e,samples:t=[],interleave:r,pool:i=null,width:n,height:o,resampleMethod:a,fillValue:l}={}){const f=e||[0,0,this.getWidth(),this.getHeight()];if(f[0]>f[2]||f[1]>f[3])throw new Error("Invalid subsets");const u=(f[2]-f[0])*(f[3]-f[1]);if(t&&t.length){for(let e=0;e<t.length;++e)if(t[e]>=this.fileDirectory.SamplesPerPixel)return Promise.reject(new RangeError(`Invalid sample index '${t[e]}'.`))}else for(let e=0;e<this.fileDirectory.SamplesPerPixel;++e)t.push(e);let h;if(r)h=c(this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,Math.max.apply(null,this.fileDirectory.BitsPerSample),u*t.length),l&&h.fill(l);else{h=[];for(let e=0;e<t.length;++e){const r=this.getArrayForSample(t[e],u);Array.isArray(l)&&e<l.length?r.fill(l[e]):l&&!Array.isArray(l)&&r.fill(l),h.push(r)}}const d=i||(0,s.getDecoder)(this.fileDirectory);return await this._readRaster(f,t,h,r,d,n,o,a)}async readRGB({window:e,pool:t=null,width:r,height:i,resampleMethod:s,enableAlpha:a=!1}={}){const l=e||[0,0,this.getWidth(),this.getHeight()];if(l[0]>l[2]||l[1]>l[3])throw new Error("Invalid subsets");const c=this.fileDirectory.PhotometricInterpretation;if(c===n.photometricInterpretations.RGB){let o=[0,1,2];if(this.fileDirectory.ExtraSamples!==n.ExtraSamplesValues.Unspecified&&a){o=[];for(let e=0;e<this.fileDirectory.BitsPerSample.length;e+=1)o.push(e)}return this.readRasters({window:e,interleave:!0,samples:o,pool:t,width:r,height:i})}let f;switch(c){case n.photometricInterpretations.WhiteIsZero:case n.photometricInterpretations.BlackIsZero:case n.photometricInterpretations.Palette:f=[0];break;case n.photometricInterpretations.CMYK:f=[0,1,2,3];break;case n.photometricInterpretations.YCbCr:case n.photometricInterpretations.CIELab:f=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const u={window:l,interleave:!0,samples:f,pool:t,width:r,height:i,resampleMethod:s},{fileDirectory:h}=this,d=await this.readRasters(u),p=2**this.fileDirectory.BitsPerSample[0];let g;switch(c){case n.photometricInterpretations.WhiteIsZero:g=(0,o.fromWhiteIsZero)(d,p);break;case n.photometricInterpretations.BlackIsZero:g=(0,o.fromBlackIsZero)(d,p);break;case n.photometricInterpretations.Palette:g=(0,o.fromPalette)(d,h.ColorMap);break;case n.photometricInterpretations.CMYK:g=(0,o.fromCMYK)(d);break;case n.photometricInterpretations.YCbCr:g=(0,o.fromYCbCr)(d);break;case n.photometricInterpretations.CIELab:g=(0,o.fromCIELab)(d);break;default:throw new Error("Unsupported photometric interpretation.")}return g.width=d.width,g.height=d.height,g}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const e=[];for(let t=0;t<this.fileDirectory.ModelTiepoint.length;t+=6)e.push({i:this.fileDirectory.ModelTiepoint[t],j:this.fileDirectory.ModelTiepoint[t+1],k:this.fileDirectory.ModelTiepoint[t+2],x:this.fileDirectory.ModelTiepoint[t+3],y:this.fileDirectory.ModelTiepoint[t+4],z:this.fileDirectory.ModelTiepoint[t+5]});return e}getGDALMetadata(e=null){const t={};if(!this.fileDirectory.GDAL_METADATA)return null;const r=this.fileDirectory.GDAL_METADATA,n=(0,i.default)(r.substring(0,r.length-1));if(!n[0].tagName)throw new Error("Failed to parse GDAL metadata XML.");const o=n[0];if("GDALMetadata"!==o.tagName)throw new Error("Unexpected GDAL metadata XML tag.");let s=o.children.filter(e=>"Item"===e.tagName);e&&(s=s.filter(t=>Number(t.attributes.sample)===e));for(let e=0;e<s.length;++e){const r=s[e];t[r.attributes.name]=r.children[0]}return t}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const e=this.fileDirectory.GDAL_NODATA;return Number(e.substring(0,e.length-1))}getOrigin(){const e=this.fileDirectory.ModelTiepoint,t=this.fileDirectory.ModelTransformation;if(e&&6===e.length)return[e[3],e[4],e[5]];if(t)return[t[3],t[7],t[11]];throw new Error("The image does not have an affine transformation.")}getResolution(e=null){const t=this.fileDirectory.ModelPixelScale,r=this.fileDirectory.ModelTransformation;if(t)return[t[0],-t[1],t[2]];if(r)return[r[0],r[5],r[10]];if(e){const[t,r,i]=e.getResolution();return[t*e.getWidth()/this.getWidth(),r*e.getHeight()/this.getHeight(),i*e.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return 1===this.geoKeys.GTRasterTypeGeoKey}getBoundingBox(){const e=this.getOrigin(),t=this.getResolution(),r=e[0],i=e[1],n=r+t[0]*this.getWidth(),o=i+t[1]*this.getHeight();return[Math.min(r,n),Math.min(i,o),Math.max(r,n),Math.max(i,o)]}};r.default=f},{"./globals":"j27V","./rgb":"fpBl","./compression":"FGCZ","./resample":"OQju"}],dqpX:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=class{constructor(e){this._dataView=new DataView(e)}get buffer(){return this._dataView.buffer}getUint64(e,t){const r=this.getUint32(e,t),i=this.getUint32(e+4,t);return t?r<<32|i:i<<32|r}getInt64(e,t){let r,i;return t?(r=this.getInt32(e,t))<<32|(i=this.getUint32(e+4,t)):(r=this.getUint32(e,t),(i=this.getInt32(e+4,t))<<32|r)}getUint8(e,t){return this._dataView.getUint8(e,t)}getInt8(e,t){return this._dataView.getInt8(e,t)}getUint16(e,t){return this._dataView.getUint16(e,t)}getInt16(e,t){return this._dataView.getInt16(e,t)}getUint32(e,t){return this._dataView.getUint32(e,t)}getInt32(e,t){return this._dataView.getInt32(e,t)}getFloat32(e,t){return this._dataView.getFloat32(e,t)}getFloat64(e,t){return this._dataView.getFloat64(e,t)}}},{}],dGLV:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=class{constructor(e,t,r,i){this._dataView=new DataView(e),this._sliceOffset=t,this._littleEndian=r,this._bigTiff=i}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(e,t){return this.sliceOffset<=e&&this.sliceTop>=e+t}readUint8(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}readInt8(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}readUint16(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}readInt16(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}readUint32(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}readInt32(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}readFloat32(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}readFloat64(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}readUint64(e){const t=this.readUint32(e),r=this.readUint32(e+4);let i;if(this._littleEndian){if(i=t+2**32*r,!Number.isSafeInteger(i))throw new Error(i+" exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return i}if(i=2**32*t+r,!Number.isSafeInteger(i))throw new Error(i+" exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return i}readInt64(e){let t,r;if(this._littleEndian){if(t=this.readInt32(e),r=this.readUint32(e+4),combined=t+2**32*r,!Number.isSafeInteger(combined))throw new Error(combined+" exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return combined}if(t=this.readUint32(e-this._sliceOffset),r=this.readInt32(e-this._sliceOffset+4),combined=2**32*t+r,!Number.isSafeInteger(combined))throw new Error(combined+" exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return combined}readOffset(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}},{}],dHPO:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("threads/register");var i=e("threads");const n="undefined"!=typeof navigator?navigator.hardwareConcurrency:null;var o=class{constructor(e=n){const t=new Worker("/decoder.worker.7cb947d7.js");this.pool=(0,i.Pool)(()=>(0,i.spawn)(t),e)}async decode(e,t){return new Promise((r,i)=>{this.pool.queue(async n=>{try{const i=await n(e,t);r(i)}catch(e){i(e)}})})}destroy(){this.pool.terminate(!0)}};r.default=o},{"./decoder.worker.js":[["decoder.worker.7cb947d7.js","LHx9"],"decoder.worker.7cb947d7.js.map","LHx9"]}],cUx7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.makeFetchSource=f,r.makeXHRSource=u,r.makeHttpSource=h,r.makeRemoteSource=function(e,t){const{forceXHR:r}=t;if("function"==typeof fetch&&!r)return f(e,t);if("undefined"!=typeof XMLHttpRequest)return u(e,t);if(o.default.get)return h(e,t);throw new Error("No remote source available")},r.makeBufferSource=function(e){return{fetch:async(t,r)=>e.slice(t,t+r)}},r.makeFileSource=function(e){const t=p(e,"r");return{async fetch(e,r){const n=await t,{buffer:o}=await g(n,i.Buffer.alloc(r),0,r,e);return o.buffer},async close(){const e=await t;return await d(e)}}},r.makeFileReaderSource=function(e){return{fetch:async(t,r)=>new Promise((i,n)=>{const o=e.slice(t,t+r),s=new FileReader;s.onload=e=>i(e.target.result),s.onerror=n,s.readAsArrayBuffer(o)})}};var i=e("buffer"),n=e("fs"),o=l(e("http")),s=l(e("https")),a=l(e("url"));function l(e){return e&&e.__esModule?e:{default:e}}class c{constructor(e,{blockSize:t=65536}={}){this.retrievalFunction=e,this.blockSize=t,this.blockRequests=new Map,this.blocks=new Map,this.blockIdsAwaitingRequest=null}async fetch(e,t,r=!1){const i=e+t,n=[],o=[],s=[];for(let t=Math.floor(e/this.blockSize)*this.blockSize;t<i;t+=this.blockSize){const e=Math.floor(t/this.blockSize);this.blocks.has(e)||this.blockRequests.has(e)||o.push(e),this.blockRequests.has(e)&&s.push(this.blockRequests.get(e)),n.push(e)}if(this.blockIdsAwaitingRequest)for(let e=0;e<o.length;++e){const t=o[e];this.blockIdsAwaitingRequest.add(t)}else this.blockIdsAwaitingRequest=new Set(o);if(r||await async function(e){return new Promise(t=>setTimeout(t,e))}(),this.blockIdsAwaitingRequest){const e=function(e){if(0===e.length)return[];const t=[];let r=[];t.push(r);for(let i=0;i<e.length;++i)0===i||e[i]===e[i-1]+1?r.push(e[i]):(r=[e[i]],t.push(r));return t}(Array.from(this.blockIdsAwaitingRequest).sort());for(const t of e){const e=this.requestData(t[0]*this.blockSize,t.length*this.blockSize);for(let r=0;r<t.length;++r){const i=t[r];this.blockRequests.set(i,(async()=>{const t=await e,n=r*this.blockSize,o=Math.min(n+this.blockSize,t.data.byteLength),s=t.data.slice(n,o);this.blockRequests.delete(i),this.blocks.set(i,{data:s,offset:t.offset+n,length:s.byteLength,top:t.offset+o})})())}}this.blockIdsAwaitingRequest=null}const a=[];for(const e of o)this.blockRequests.has(e)&&a.push(this.blockRequests.get(e));return await Promise.all(a),await Promise.all(s),function(e,t,r){const i=t+r,n=new ArrayBuffer(r),o=new Uint8Array(n);for(const r of e){const e=r.offset-t,n=r.top-i;let s,a=0,l=0;e<0?a=-e:e>0&&(l=e),n<0?s=r.length-a:n>0&&(s=i-r.offset-a);const c=new Uint8Array(r.data,a,s);o.set(c,l)}return n}(n.map(e=>this.blocks.get(e)),e,t)}async requestData(e,t){const r=await this.retrievalFunction(e,t);return r.length?r.length!==r.data.byteLength&&(r.data=r.data.slice(0,r.length)):r.length=r.data.byteLength,r.top=r.offset+r.length,r}}function f(e,{headers:t={},blockSize:r}={}){return new c(async(r,i)=>{const n=await fetch(e,{headers:{...t,Range:`bytes=${r}-${r+i-1}`}});if(n.ok){if(206===n.status)return{data:n.arrayBuffer?await n.arrayBuffer():(await n.buffer()).buffer,offset:r,length:i};{const e=n.arrayBuffer?await n.arrayBuffer():(await n.buffer()).buffer;return{data:e,offset:0,length:e.byteLength}}}throw new Error("Error fetching data.")},{blockSize:r})}function u(e,{headers:t={},blockSize:r}={}){return new c(async(r,i)=>new Promise((n,o)=>{const s=new XMLHttpRequest;s.open("GET",e),s.responseType="arraybuffer";const a={...t,Range:`bytes=${r}-${r+i-1}`};for(const[e,t]of Object.entries(a))s.setRequestHeader(e,t);s.onload=()=>{const e=s.response;206===s.status?n({data:e,offset:r,length:i}):n({data:e,offset:0,length:e.byteLength})},s.onerror=o,s.send()}),{blockSize:r})}function h(e,{headers:t={},blockSize:r}={}){return new c(async(r,n)=>new Promise((l,c)=>{const f=a.default.parse(e);("http:"===f.protocol?o.default:s.default).get({...f,headers:{...t,Range:`bytes=${r}-${r+n-1}`}},e=>{const t=[];e.on("data",e=>{t.push(e)}),e.on("end",()=>{const e=i.Buffer.concat(t).buffer;l({data:e,offset:r,length:e.byteLength})})}).on("error",c)}),{blockSize:r})}function d(e){return new Promise((t,r)=>{(0,n.close)(e,e=>{e?r(e):t()})})}function p(e,t,r){return new Promise((i,o)=>{(0,n.open)(e,t,r,(e,t)=>{e?o(e):i(t)})})}function g(...e){return new Promise((t,r)=>{(0,n.read)(...e,(e,i,n)=>{e?r(e):t({bytesRead:i,buffer:n})})})}},{}],FOZT:[function(e,t,r){"use strict";function i(e){const t=[],{length:r}=e;for(let i=0;i<r;i++)t.push(e[i]);return t}Object.defineProperty(r,"__esModule",{value:!0}),r.assign=function(e,t){for(const r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},r.chunk=function(e,t){const r=[],i=e.length;for(let n=0;n<i;n+=t){const i=[];for(let r=n;r<n+t;r++)i.push(e[r]);r.push(i)}return r},r.endsWith=function(e,t){return!(e.length<t.length)&&e.substr(e.length-t.length)===t},r.forEach=function(e,t){const{length:r}=e;for(let i=0;i<r;i++)t(e[i],i)},r.invert=function(e){const t={};for(const r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t},r.range=function(e){const t=[];for(let r=0;r<e;r++)t.push(r);return t},r.times=function(e,t){const r=[];for(let i=0;i<e;i++)r.push(t(i));return r},r.toArray=i,r.toArrayRecursively=function e(t){return t.length?i(t).map(e):t}},{}],BGyE:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.writeGeotiff=function(e,t){let r,o,s,l;"number"==typeof e[0]?(r=t.height||t.ImageLength,s=t.width||t.ImageWidth,o=e.length/(r*s),l=e):(o=e.length,r=e[0].length,s=e[0][0].length,l=[],(0,n.times)(r,t=>{(0,n.times)(s,r=>{(0,n.times)(o,i=>{l.push(e[i][t][r])})})})),t.ImageLength=r,delete t.height,t.ImageWidth=s,delete t.width,t.BitsPerSample||(t.BitsPerSample=(0,n.times)(o,()=>8)),d.forEach(e=>{const r=e[0];if(!t[r]){const i=e[1];t[r]=i}}),t.PhotometricInterpretation||(t.PhotometricInterpretation=3===t.BitsPerSample.length?2:1),t.SamplesPerPixel||(t.SamplesPerPixel=[o]),t.StripByteCounts||(t.StripByteCounts=[o*r*s]),t.ModelPixelScale||(t.ModelPixelScale=[360/s,180/r,0]),t.SampleFormat||(t.SampleFormat=(0,n.times)(o,()=>1));const c=Object.keys(t).filter(e=>(0,n.endsWith)(e,"GeoKey")).sort((e,t)=>a[e]-a[t]);if(!t.GeoKeyDirectory){const e=[1,1,0,c.length];c.forEach(r=>{const n=Number(a[r]);let o,s,l;e.push(n),"SHORT"===i.fieldTagTypes[n]?(o=1,s=0,l=t[r]):"GeogCitationGeoKey"===r?(o=t.GeoAsciiParams.length,s=Number(a.GeoAsciiParams),l=0):console.log("[geotiff.js] couldn't get TIFFTagLocation for "+r),e.push(s),e.push(o),e.push(l)}),t.GeoKeyDirectory=e}for(const e in c)c.hasOwnProperty(e)&&delete t[e];["Compression","ExtraSamples","GeographicTypeGeoKey","GTModelTypeGeoKey","GTRasterTypeGeoKey","ImageLength","ImageWidth","PhotometricInterpretation","PlanarConfiguration","ResolutionUnit","SamplesPerPixel","XPosition","YPosition"].forEach(e=>{t[e]&&(t[e]=(e=>Array.isArray(e)?e:[e])(t[e]))});const f=(e=>{const t={};for(const r in e)"StripOffsets"!==r&&(a[r]||console.error(r,"not in name2code:",Object.keys(a)),t[a[r]]=e[r]);return t})(t);return h(l,s,r,f)};var i=e("./globals"),n=e("./utils");const o=(0,n.invert)(i.fieldTagNames),s=(0,n.invert)(i.geoKeyNames),a={};(0,n.assign)(a,o),(0,n.assign)(a,s);const l=(0,n.invert)(i.fieldTypeNames),c={nextZero:(e,t)=>{let r=t;for(;0!==e[r];)r++;return r},readUshort:(e,t)=>e[t]<<8|e[t+1],readShort:(e,t)=>{const r=c.ui8;return r[0]=e[t+1],r[1]=e[t+0],c.i16[0]},readInt:(e,t)=>{const r=c.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],c.i32[0]},readUint:(e,t)=>{const r=c.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],c.ui32[0]},readASCII:(e,t,r)=>r.map(r=>String.fromCharCode(e[t+r])).join(""),readFloat:(e,t)=>{const r=c.ui8;return(0,n.times)(4,i=>{r[i]=e[t+3-i]}),c.fl32[0]},readDouble:(e,t)=>{const r=c.ui8;return(0,n.times)(8,i=>{r[i]=e[t+7-i]}),c.fl64[0]},writeUshort:(e,t,r)=>{e[t]=r>>8&255,e[t+1]=255&r},writeUint:(e,t,r)=>{e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r>>0&255},writeASCII:(e,t,r)=>{(0,n.times)(r.length,i=>{e[t+i]=r.charCodeAt(i)})},ui8:new Uint8Array(8)};c.fl64=new Float64Array(c.ui8.buffer),c.writeDouble=(e,t,r)=>{c.fl64[0]=r,(0,n.times)(8,r=>{e[t+r]=c.ui8[7-r]})};const f=(e,t,r,o)=>{let s=r;const a=Object.keys(o).filter(e=>null!=e&&"undefined"!==e);e.writeUshort(t,s,a.length);let c=(s+=2)+12*a.length+4;for(const r of a){let a=null;"number"==typeof r?a=r:"string"==typeof r&&(a=parseInt(r,10));const f=i.fieldTagTypes[a],u=l[f];if(null==f||void 0===f||void 0===f)throw new Error("unknown type of tag: "+a);let h=o[r];if(void 0===h)throw new Error("failed to get value for key "+r);"ASCII"===f&&"string"==typeof h&&!1===(0,n.endsWith)(h,"\0")&&(h+="\0");const d=h.length;e.writeUshort(t,s,a),s+=2,e.writeUshort(t,s,u),s+=2,e.writeUint(t,s,d);let p=[-1,1,1,2,4,8,0,0,0,0,0,0,8][u]*d,g=s+=4;p>4&&(e.writeUint(t,s,c),g=c),"ASCII"===f?e.writeASCII(t,g,h):"SHORT"===f?(0,n.times)(d,r=>{e.writeUshort(t,g+2*r,h[r])}):"LONG"===f?(0,n.times)(d,r=>{e.writeUint(t,g+4*r,h[r])}):"RATIONAL"===f?(0,n.times)(d,r=>{e.writeUint(t,g+8*r,Math.round(1e4*h[r])),e.writeUint(t,g+8*r+4,1e4)}):"DOUBLE"===f&&(0,n.times)(d,r=>{e.writeDouble(t,g+8*r,h[r])}),p>4&&(c+=p+=1&p),s+=4}return[s,c]},u=e=>{const t=new Uint8Array(1e3);let r=4;const i=c;t[0]=77,t[1]=77,t[3]=42;let n=8;if(i.writeUint(t,r,n),r+=4,e.forEach((r,o)=>{const s=f(i,t,n,r);n=s[1],o<e.length-1&&i.writeUint(t,s[0],n)}),t.slice)return t.slice(0,n).buffer;const o=new Uint8Array(n);for(let e=0;e<n;e++)o[e]=t[e];return o.buffer},h=(e,t,r,i)=>{if(null==r)throw new Error("you passed into encodeImage a width of type "+r);if(null==t)throw new Error("you passed into encodeImage a width of type "+t);const o={256:[t],257:[r],273:[1e3],278:[r],305:"geotiff.js"};if(i)for(const e in i)i.hasOwnProperty(e)&&(o[e]=i[e]);const s=new Uint8Array(u([o])),a=new Uint8Array(e),l=o[277],c=new Uint8Array(1e3+t*r*l);return(0,n.times)(s.length,e=>{c[e]=s[e]}),(0,n.forEach)(a,(e,t)=>{c[1e3+t]=e}),c.buffer},d=[["Compression",1],["PlanarConfiguration",1],["XPosition",0],["YPosition",0],["ResolutionUnit",1],["ExtraSamples",0],["GeoAsciiParams","WGS 84\0"],["ModelTiepoint",[0,0,0,-180,90,0]],["GTModelTypeGeoKey",2],["GTRasterTypeGeoKey",1],["GeographicTypeGeoKey",4326],["GeogCitationGeoKey","WGS 84"]]},{"./globals":"j27V","./utils":"FOZT"}],bsJs:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fromUrl=async function(e,t={}){return w.fromSource((0,a.makeRemoteSource)(e,t))},r.fromArrayBuffer=async function(e){return w.fromSource((0,a.makeBufferSource)(e))},r.fromFile=async function(e){return w.fromSource((0,a.makeFileSource)(e))},r.fromBlob=async function(e){return w.fromSource((0,a.makeFileReaderSource)(e))},r.fromUrls=async function(e,t=[],r={}){const i=await w.fromSource((0,a.makeRemoteSource)(e,r)),n=await Promise.all(t.map(e=>w.fromSource((0,a.makeRemoteSource)(e,r))));return new T(i,n)},r.writeArrayBuffer=async function(e,t){return(0,c.writeGeotiff)(e,t)},Object.defineProperty(r,"Pool",{enumerable:!0,get:function(){return s.default}}),r.rgb=r.globals=r.MultiGeoTIFF=r.default=r.GeoTIFF=void 0;var i=d(e("./geotiffimage")),n=d(e("./dataview64")),o=d(e("./dataslice")),s=d(e("./pool")),a=e("./source"),l=h(e("./globals"));r.globals=l;var c=e("./geotiffwriter"),f=h(e("./rgb"));function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function h(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=i?Object.getOwnPropertyDescriptor(e,n):null;o&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n]}return r.default=e,t&&t.set(e,r),r}function d(e){return e&&e.__esModule?e:{default:e}}function p(e){switch(e){case l.fieldTypes.BYTE:case l.fieldTypes.ASCII:case l.fieldTypes.SBYTE:case l.fieldTypes.UNDEFINED:return 1;case l.fieldTypes.SHORT:case l.fieldTypes.SSHORT:return 2;case l.fieldTypes.LONG:case l.fieldTypes.SLONG:case l.fieldTypes.FLOAT:case l.fieldTypes.IFD:return 4;case l.fieldTypes.RATIONAL:case l.fieldTypes.SRATIONAL:case l.fieldTypes.DOUBLE:case l.fieldTypes.LONG8:case l.fieldTypes.SLONG8:case l.fieldTypes.IFD8:return 8;default:throw new RangeError("Invalid field type: "+e)}}function g(e){const t=e.GeoKeyDirectory;if(!t)return null;const r={};for(let i=4;i<=4*t[3];i+=4){const n=l.geoKeyNames[t[i]],o=t[i+1]?l.fieldTagNames[t[i+1]]:null,s=t[i+2],a=t[i+3];let c=null;if(o){if(null==(c=e[o]))throw new Error(`Could not get value of geoKey '${n}'.`);"string"==typeof c?c=c.substring(a,a+s-1):c.subarray&&(c=c.subarray(a,a+s-1))}else c=a;r[n]=c}return r}function y(e,t,r,i){let n=null,o=null;const s=p(t);switch(t){case l.fieldTypes.BYTE:case l.fieldTypes.ASCII:case l.fieldTypes.UNDEFINED:n=new Uint8Array(r),o=e.readUint8;break;case l.fieldTypes.SBYTE:n=new Int8Array(r),o=e.readInt8;break;case l.fieldTypes.SHORT:n=new Uint16Array(r),o=e.readUint16;break;case l.fieldTypes.SSHORT:n=new Int16Array(r),o=e.readInt16;break;case l.fieldTypes.LONG:case l.fieldTypes.IFD:n=new Uint32Array(r),o=e.readUint32;break;case l.fieldTypes.SLONG:n=new Int32Array(r),o=e.readInt32;break;case l.fieldTypes.LONG8:case l.fieldTypes.IFD8:n=new Array(r),o=e.readUint64;break;case l.fieldTypes.SLONG8:n=new Array(r),o=e.readInt64;break;case l.fieldTypes.RATIONAL:n=new Uint32Array(2*r),o=e.readUint32;break;case l.fieldTypes.SRATIONAL:n=new Int32Array(2*r),o=e.readInt32;break;case l.fieldTypes.FLOAT:n=new Float32Array(r),o=e.readFloat32;break;case l.fieldTypes.DOUBLE:n=new Float64Array(r),o=e.readFloat64;break;default:throw new RangeError("Invalid field type: "+t)}if(t!==l.fieldTypes.RATIONAL&&t!==l.fieldTypes.SRATIONAL)for(let t=0;t<r;++t)n[t]=o.call(e,i+t*s);else for(let t=0;t<r;t+=2)n[t]=o.call(e,i+t*s),n[t+1]=o.call(e,i+(t*s+4));return t===l.fieldTypes.ASCII?String.fromCharCode.apply(null,n):n}r.rgb=f;class m{async readRasters(e={}){const{window:t,width:r,height:i}=e;let{resX:n,resY:o,bbox:s}=e;const a=await this.getImage();let l=a;const c=await this.getImageCount(),f=a.getBoundingBox();if(t&&s)throw new Error('Both "bbox" and "window" passed.');if(r||i){if(t){const[e,r]=a.getOrigin(),[i,n]=a.getResolution();s=[e+t[0]*i,r+t[1]*n,e+t[2]*i,r+t[3]*n]}const e=s||f;if(r){if(n)throw new Error("Both width and resX passed");n=(e[2]-e[0])/r}if(i){if(o)throw new Error("Both width and resY passed");o=(e[3]-e[1])/i}}if(n||o){const e=[];for(let t=0;t<c;++t){const r=await this.getImage(t),{SubfileType:i,NewSubfileType:n}=r.fileDirectory;(0===t||2===i||1&n)&&e.push(r)}e.sort((e,t)=>e.getWidth()-t.getWidth());for(let t=0;t<e.length;++t){const r=e[t],i=(f[2]-f[0])/r.getWidth(),s=(f[3]-f[1])/r.getHeight();if(l=r,n&&n>i||o&&o>s)break}}let u=t;if(s){const[e,t]=a.getOrigin(),[r,i]=l.getResolution(a);u=[Math.round((s[0]-e)/r),Math.round((s[1]-t)/i),Math.round((s[2]-e)/r),Math.round((s[3]-t)/i)],u=[Math.min(u[0],u[2]),Math.min(u[1],u[3]),Math.max(u[0],u[2]),Math.max(u[1],u[3])]}return l.readRasters({...e,window:u})}}class w extends m{constructor(e,t,r,i,n={}){super(),this.source=e,this.littleEndian=t,this.bigTiff=r,this.firstIFDOffset=i,this.cache=n.cache||!1,this.fileDirectories=null,this.fileDirectoriesParsing=null,this.ghostValues=null}async getSlice(e,t){const r=this.bigTiff?4048:1024;return new o.default(await this.source.fetch(e,void 0!==t?t:r),e,this.littleEndian,this.bigTiff)}async parseFileDirectories(){let e=this.firstIFDOffset;const t=this.bigTiff?8:2,r=this.bigTiff?20:12,i=[];for(;0!==e;){let n=await this.getSlice(e);const o=this.bigTiff?n.readUint64(e):n.readUint16(e),s=o*r+(this.bigTiff?16:6);n.covers(e,s)||(n=await this.getSlice(e,s));const a={};let c=e+(this.bigTiff?8:2);for(let e=0;e<o;c+=r,++e){const e=n.readUint16(c),t=n.readUint16(c+2),r=this.bigTiff?n.readUint64(c+4):n.readUint32(c+4);let i,o;const s=p(t),f=c+(this.bigTiff?12:8);if(s*r<=(this.bigTiff?8:4))i=y(n,t,r,f);else{const e=n.readOffset(f),o=p(t)*r;i=n.covers(e,o)?y(n,t,r,e):y(await this.getSlice(e,o),t,r,e)}o=1===r&&-1===l.arrayFields.indexOf(e)&&t!==l.fieldTypes.RATIONAL&&t!==l.fieldTypes.SRATIONAL?i[0]:i,a[l.fieldTagNames[e]]=o}i.push([a,g(a)]),e=n.readOffset(e+t+r*o)}return i}async getImage(e=0){this.fileDirectories||(this.fileDirectoriesParsing||(this.fileDirectoriesParsing=this.parseFileDirectories()),this.fileDirectories=await this.fileDirectoriesParsing);const t=this.fileDirectories[e];if(!t)throw new RangeError("Invalid image index");return new i.default(t[0],t[1],this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){return this.fileDirectories||(this.fileDirectoriesParsing||(this.fileDirectoriesParsing=this.parseFileDirectories()),this.fileDirectories=await this.fileDirectoriesParsing),this.fileDirectories.length}async getGhostValues(){const e=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const t="GDAL_STRUCTURAL_METADATA_SIZE=",r=t.length+100;let i=await this.getSlice(e,r);if(t===y(i,l.fieldTypes.ASCII,t.length,e)){const t=y(i,l.fieldTypes.ASCII,r,e).split("\n")[0],n=Number(t.split("=")[1].split(" ")[0])+t.length;n>r&&(i=await this.getSlice(e,n));const o=y(i,l.fieldTypes.ASCII,n,e);this.ghostValues={},o.split("\n").filter(e=>e.length>0).map(e=>e.split("=")).forEach(([e,t])=>{this.ghostValues[e]=t})}return this.ghostValues}static async fromSource(e,t){const r=await e.fetch(0,1024),i=new n.default(r),o=i.getUint16(0,0);let s;if(18761===o)s=!0;else{if(19789!==o)throw new TypeError("Invalid byte order value.");s=!1}const a=i.getUint16(2,s);let l;if(42===a)l=!1;else{if(43!==a)throw new TypeError("Invalid magic number.");if(l=!0,8!==i.getUint16(4,s))throw new Error("Unsupported offset byte-size.")}const c=l?i.getUint64(8,s):i.getUint32(4,s);return new w(e,s,l,c,t)}close(){return"function"==typeof this.source.close&&this.source.close()}}r.GeoTIFF=w;var b=w;r.default=b;class T extends m{constructor(e,t){super(),this.mainFile=e,this.overviewFiles=t,this.imageFiles=[e].concat(t),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const e=[this.mainFile.parseFileDirectories()].concat(this.overviewFiles.map(e=>e.parseFileDirectories()));return this.fileDirectoriesPerFile=await Promise.all(e),this.fileDirectoriesPerFile}async getImage(e=0){this.fileDirectoriesPerFile||(this.fileDirectoriesPerFileParsing||(this.fileDirectoriesPerFileParsing=this.parseFileDirectoriesPerFile()),this.fileDirectoriesPerFile=await this.fileDirectoriesPerFileParsing);let t=e;for(let e=0;e<this.fileDirectoriesPerFile.length;++e){const r=this.fileDirectoriesPerFile[e];if(t<r.length){const n=this.imageFiles[e];return new i.default(r[t][0],r[t][1],n.dataView,n.littleEndian,n.cache,n.source)}t-=r.length}throw new RangeError("Invalid image index")}async getImageCount(){return this.fileDirectoriesPerFile||(this.fileDirectoriesPerFileParsing||(this.fileDirectoriesPerFileParsing=this.parseFileDirectoriesPerFile()),this.fileDirectoriesPerFile=await this.fileDirectoriesPerFileParsing),this.fileDirectoriesPerFile.reduce((e,t)=>e+t.length,0)}}r.MultiGeoTIFF=T},{"./geotiffimage":"eOWo","./dataview64":"dqpX","./dataslice":"dGLV","./pool":"dHPO","./source":"cUx7","./globals":"j27V","./geotiffwriter":"BGyE","./rgb":"fpBl"}],epB2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("./geotiff");Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return i[e]}})}))},{"./geotiff":"bsJs"}]},{},["epB2"])},function(e,t,r){"use strict";e.exports={countIn1D:function(e){return e.reduce((function(e,t){return void 0===e[t]?e[t]=1:e[t]++,e}),{})},countIn2D:function(e){return e.reduce((function(e,t){return t.forEach((function(t){void 0===e[t]?e[t]=1:e[t]++})),e}),{})},unflatten:function(e,t){for(var r=t.height,i=t.width,n=[],o=0;o<r;o++){var s=o*i,a=s+i;n.push(e.slice(s,a))}return n}}},function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=u(r(3)),s=u(r(5)),a=u(r(7)),l=r(1),c=r(0),f=u(r(9));function u(e){return e&&e.__esModule?e:{default:e}}function h(e,t){var r=t.left,i=t.top,n=t.right,o=t.bottom,s=t.width,a=t.height;return e.readRasters({window:[r,i,n,o],width:s,height:a,resampleMethod:"bilinear"}).then((function(e){return e.map((function(e){return(0,l.unflatten)(e,{height:a,width:s})}))}))}var d=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n&&console.log("starting GeoRaster.constructor with",t,r),this._web_worker_is_available="undefined"!=typeof window&&"undefined"!==window.Worker,this._blob_is_available="undefined"!=typeof Blob,this._url_is_available="undefined"!=typeof URL,"object"===(void 0===t?"undefined":i(t))&&t.constructor&&"Buffer"===t.constructor.name&&!1===Buffer.isBuffer(t)&&(t=new Buffer(t)),"string"==typeof t?(n&&console.log("data is a url"),this._data=t,this._url=t,this.rasterType="geotiff",this.sourceType="url"):"undefined"!=typeof Buffer&&Buffer.isBuffer(t)?(n&&console.log("data is a buffer"),this._data=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength),this.rasterType="geotiff",this.sourceType="Buffer"):t instanceof ArrayBuffer?(this._data=t,this.rasterType="geotiff",this.sourceType="ArrayBuffer"):Array.isArray(t)&&r&&(this._data=t,this.rasterType="object",this._metadata=r),n&&console.log("this after construction:",this)}return n(e,[{key:"preinitialize",value:function(e){var t=this;if(e&&console.log("starting preinitialize"),this._url){var r=this._url+".ovr";return function(e){try{return(0,o.default)(e,{method:"HEAD"}).then((function(e){return 200===e.status})).catch((function(e){return!1}))}catch(e){return Promise.resolve(!1)}}(r).then((function(i){return e&&console.log("overview exists:",i),i?(0,c.fromUrls)(t._url,[r],{cache:!0,forceXHR:!1}):(0,c.fromUrl)(t._url,{cache:!0,forceXHR:!1})}))}return Promise.resolve()}},{key:"initialize",value:function(e){var t=this;return this.preinitialize(e).then((function(r){return new Promise((function(i,n){if(e&&console.log("starting GeoRaster.initialize"),e&&console.log("this",t),"object"===t.rasterType||"geotiff"===t.rasterType||"tiff"===t.rasterType)if(t._web_worker_is_available){var o=new s.default;o.onmessage=function(n){e&&console.log("main thread received message:",n);var o=n.data;for(var s in o)t[s]=o[s];t._url&&(t._geotiff=r,t.getValues=function(e){return h(this._geotiff,e)}),t.toCanvas=function(e){return(0,f.default)(this,e)},i(t)},e&&console.log("about to postMessage"),t._data instanceof ArrayBuffer?o.postMessage({data:t._data,rasterType:t.rasterType,sourceType:t.sourceType,metadata:t._metadata},[t._data]):o.postMessage({data:t._data,rasterType:t.rasterType,sourceType:t.sourceType,metadata:t._metadata})}else e&&console.log("web worker is not available"),(0,a.default)({data:t._data,rasterType:t.rasterType,sourceType:t.sourceType,metadata:t._metadata},e).then((function(n){e&&console.log("result:",n),t._url&&(n._geotiff=r,n.getValues=function(e){return h(this._geotiff,e)}),n.toCanvas=function(e){return(0,f.default)(this,e)},i(n)})).catch(n);else n("couldn't find a way to parse")}))}))}}]),e}(),p=function(e,t,r){if(r&&console.log("starting parseGeoraster with ",e,t),void 0===e){throw Error("[Georaster.parseGeoraster] Error. You passed in undefined to parseGeoraster. We can't make a raster out of nothing!")}return new d(e,t,r).initialize(r)};void 0!==e.exports&&(e.exports=p),"undefined"!=typeof window?window.parseGeoraster=p:"undefined"!=typeof self&&(self.parseGeoraster=p)},function(e,t,r){var i=r(4),n=i.default||i,o=function(e,t){return/^\/\//.test(e)&&(e="https:"+e),n.call(this,e,t)};e.exports=t=o,t.fetch=o,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,t.default=o},function(t,r){t.exports=e},function(e,t,r){"use strict";e.exports=function(){return r(6)('!function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],i=!0,n=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(e){n=!0,o=e}finally{try{!i&&a.return&&a.return()}finally{if(n)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function(e,t){return new Promise((function(r,l){try{t&&console.log("starting parseData with",e),t&&console.log("\\tGeoTIFF:","undefined"==typeof GeoTIFF?"undefined":n(GeoTIFF));var c={},f=void 0,u=void 0;if("object"===e.rasterType)c.values=e.data,c.height=f=e.metadata.height||c.values[0].length,c.width=u=e.metadata.width||c.values[0][0].length,c.pixelHeight=e.metadata.pixelHeight,c.pixelWidth=e.metadata.pixelWidth,c.projection=e.metadata.projection,c.xmin=e.metadata.xmin,c.ymax=e.metadata.ymax,c.noDataValue=e.metadata.noDataValue,c.numberOfRasters=c.values.length,c.xmax=c.xmin+c.width*c.pixelWidth,c.ymin=c.ymax-c.height*c.pixelHeight,c._data=null,r(a(c));else if("geotiff"===e.rasterType){c._data=e.data;var h=o.fromArrayBuffer;"url"===e.sourceType&&(h=o.fromUrl),t&&console.log("data.rasterType is geotiff"),r(h(e.data).then((function(r){return t&&console.log("geotiff:",r),r.getImage().then((function(r){t&&console.log("image:",r);var n=r.fileDirectory,o=r.getGeoKeys(),l=o.GeographicTypeGeoKey,h=o.ProjectedCSTypeGeoKey;c.projection=l||h,t&&console.log("projection:",c.projection),c.height=f=r.getHeight(),t&&console.log("result.height:",c.height),c.width=u=r.getWidth(),t&&console.log("result.width:",c.width);var d=r.getResolution(),p=i(d,2),g=p[0],y=p[1];c.pixelHeight=Math.abs(y),c.pixelWidth=Math.abs(g);var m=r.getOrigin(),w=i(m,2),b=w[0],T=w[1];return c.xmin=b,c.xmax=c.xmin+u*c.pixelWidth,c.ymax=T,c.ymin=c.ymax-f*c.pixelHeight,c.noDataValue=n.GDAL_NODATA?parseFloat(n.GDAL_NODATA):null,c.numberOfRasters=n.SamplesPerPixel,"url"!==e.sourceType?r.readRasters().then((function(e){return c.values=e.map((function(e){return(0,s.unflatten)(e,{height:f,width:u})})),a(c)})):c}))})))}}catch(e){l(e),console.error("[georaster] error parsing georaster:",e)}}))};var o=r(2),s=r(4);function a(e,t){var r=e.noDataValue,i=e.height,n=e.width;return new Promise((function(o,s){e.maxs=[],e.mins=[],e.ranges=[];for(var a=void 0,l=void 0,c=0;c<e.numberOfRasters;c++){var f=e.values[c];t&&console.log("[georaster] rows:",f);for(var u=0;u<i;u++)for(var h=f[u],d=0;d<n;d++){var p=h[d];p==r||isNaN(p)||(void 0===l||p<l?l=p:(void 0===a||p>a)&&(a=p))}e.maxs.push(a),e.mins.push(l),e.ranges.push(a-l)}o(e)}))}},function(e,t,r){"use strict";r.r(t);var i=r(0),n=r.n(i);self;onmessage=e=>{const t=e.data;n()(t).then(e=>{e._data instanceof ArrayBuffer?postMessage(e,[e._data]):postMessage(e),close()})}},function(e,t,r){parcelRequire=function(t,i,n,o){var s,a="function"==typeof parcelRequire&&parcelRequire;function l(e,n){if(!i[e]){if(!t[e]){var o="function"==typeof parcelRequire&&parcelRequire;if(!n&&o)return o(e,!0);if(a)return a(e,!0);if("string"==typeof e)return r(3)(e);var s=new Error("Cannot find module \'"+e+"\'");throw s.code="MODULE_NOT_FOUND",s}f.resolve=function(r){return t[e][1][r]||r},f.cache={};var c=i[e]=new l.Module(e);t[e][0].call(c.exports,f,c,c.exports,this)}return i[e].exports;function f(e){return l(f.resolve(e))}}l.isParcelRequire=!0,l.Module=function(e){this.id=e,this.bundle=l,this.exports={}},l.modules=t,l.cache=i,l.parent=a,l.register=function(e,r){t[e]=[function(e,t){t.exports=r},{}]};for(var c=0;c<n.length;c++)try{l(n[c])}catch(t){s||(s=t)}if(n.length){var f=l(n[n.length-1]);e.exports=f}if(parcelRequire=l,s)throw s;return l}({j27V:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.geoKeys=r.geoKeyNames=r.ExtraSamplesValues=r.photometricInterpretations=r.fieldTypes=r.fieldTypeNames=r.arrayFields=r.fieldTagTypes=r.fieldTags=r.fieldTagNames=void 0;const i={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams"};r.fieldTagNames=i;const n={};r.fieldTags=n;for(const e in i)i.hasOwnProperty(e)&&(n[i[e]]=parseInt(e,10));r.fieldTagTypes={256:"SHORT",257:"SHORT",258:"SHORT",259:"SHORT",262:"SHORT",273:"LONG",274:"SHORT",277:"SHORT",278:"LONG",279:"LONG",282:"RATIONAL",283:"RATIONAL",284:"SHORT",286:"SHORT",287:"RATIONAL",296:"SHORT",305:"ASCII",306:"ASCII",338:"SHORT",339:"SHORT",513:"LONG",514:"LONG",1024:"SHORT",1025:"SHORT",2048:"SHORT",2049:"ASCII",33550:"DOUBLE",33922:"DOUBLE",34665:"LONG",34735:"SHORT",34737:"ASCII",42113:"ASCII"};const o=[n.BitsPerSample,n.ExtraSamples,n.SampleFormat,n.StripByteCounts,n.StripOffsets,n.StripRowCounts,n.TileByteCounts,n.TileOffsets];r.arrayFields=o;const s={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"};r.fieldTypeNames=s;const a={};r.fieldTypes=a;for(const e in s)s.hasOwnProperty(e)&&(a[s[e]]=parseInt(e,10));r.photometricInterpretations={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9};r.ExtraSamplesValues={Unspecified:0,Assocalpha:1,Unassalpha:2};const l={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"};r.geoKeyNames=l;const c={};r.geoKeys=c;for(const e in l)l.hasOwnProperty(e)&&(c[l[e]]=parseInt(e,10))},{}],fpBl:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fromWhiteIsZero=function(e,t){const{width:r,height:i}=e,n=new Uint8Array(r*i*3);let o;for(let r=0,i=0;r<e.length;++r,i+=3)o=256-e[r]/t*256,n[i]=o,n[i+1]=o,n[i+2]=o;return n},r.fromBlackIsZero=function(e,t){const{width:r,height:i}=e,n=new Uint8Array(r*i*3);let o;for(let r=0,i=0;r<e.length;++r,i+=3)o=e[r]/t*256,n[i]=o,n[i+1]=o,n[i+2]=o;return n},r.fromPalette=function(e,t){const{width:r,height:i}=e,n=new Uint8Array(r*i*3),o=t.length/3,s=t.length/3*2;for(let r=0,i=0;r<e.length;++r,i+=3){const a=e[r];n[i]=t[a]/65536*256,n[i+1]=t[a+o]/65536*256,n[i+2]=t[a+s]/65536*256}return n},r.fromCMYK=function(e){const{width:t,height:r}=e,i=new Uint8Array(t*r*3);for(let t=0,r=0;t<e.length;t+=4,r+=3){const n=e[t],o=e[t+1],s=e[t+2],a=e[t+3];i[r]=(255-n)/256*255*((255-a)/256),i[r+1]=(255-o)/256*255*((255-a)/256),i[r+2]=(255-s)/256*255*((255-a)/256)}return i},r.fromYCbCr=function(e){const{width:t,height:r}=e,i=new Uint8ClampedArray(t*r*3);for(let t=0,r=0;t<e.length;t+=3,r+=3){const n=e[t],o=e[t+1],s=e[t+2];i[r]=n+1.402*(s-128),i[r+1]=n-.34414*(o-128)-.71414*(s-128),i[r+2]=n+1.772*(o-128)}return i},r.fromCIELab=function(e){const{width:t,height:r}=e,i=new Uint8Array(t*r*3);for(let t=0,r=0;t<e.length;t+=3,r+=3){let n,o,s,a=(e[t+0]+16)/116,l=(e[t+1]<<24>>24)/500+a,c=a-(e[t+2]<<24>>24)/200;n=(n=3.2406*(l=.95047*(l*l*l>.008856?l*l*l:(l-16/116)/7.787))+-1.5372*(a=1*(a*a*a>.008856?a*a*a:(a-16/116)/7.787))+-.4986*(c=1.08883*(c*c*c>.008856?c*c*c:(c-16/116)/7.787)))>.0031308?1.055*n**(1/2.4)-.055:12.92*n,o=(o=-.9689*l+1.8758*a+.0415*c)>.0031308?1.055*o**(1/2.4)-.055:12.92*o,s=(s=.0557*l+-.204*a+1.057*c)>.0031308?1.055*s**(1/2.4)-.055:12.92*s,i[r]=255*Math.max(0,Math.min(1,n)),i[r+1]=255*Math.max(0,Math.min(1,o)),i[r+2]=255*Math.max(0,Math.min(1,s))}return i}},{}],IKSA:[function(e,t,r){"use strict";function i(e,t){let r=e.length-t,i=0;do{for(let r=t;r>0;r--)e[i+t]+=e[i],i++;r-=t}while(r>0)}function n(e,t,r){let i=0,n=e.length;const o=n/r;for(;n>t;){for(let r=t;r>0;--r)e[i+t]+=e[i],++i;n-=t}const s=e.slice();for(let t=0;t<o;++t)for(let i=0;i<r;++i)e[r*t+i]=s[(r-i-1)*o+t]}Object.defineProperty(r,"__esModule",{value:!0}),r.applyPredictor=function(e,t,r,o,s,a){if(!t||1===t)return e;for(let e=0;e<s.length;++e){if(s[e]%8!=0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(s[e]!==s[0])throw new Error("When decoding with predictor, all samples must have the same size.")}const l=s[0]/8,c=2===a?1:s.length;for(let a=0;a<o&&!(a*c*r*l>=e.byteLength);++a){let o;if(2===t){switch(s[0]){case 8:o=new Uint8Array(e,a*c*r*l,c*r*l);break;case 16:o=new Uint16Array(e,a*c*r*l,c*r*l/2);break;case 32:o=new Uint32Array(e,a*c*r*l,c*r*l/4);break;default:throw new Error(`Predictor 2 not allowed with ${s[0]} bits per sample.`)}i(o,c)}else 3===t&&n(o=new Uint8Array(e,a*c*r*l,c*r*l),c,l)}return e}},{}],FJDe:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("../predictor");r.default=class{decode(e,t){const r=this.decodeBlock(t),n=e.Predictor||1;if(1!==n){const t=!e.StripOffsets,o=t?e.TileWidth:e.ImageWidth,s=t?e.TileLength:e.RowsPerStrip||e.ImageLength;return(0,i.applyPredictor)(r,n,o,s,e.BitsPerSample,e.PlanarConfiguration)}return r}}},{"../predictor":"IKSA"}],V9bQ:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));class n extends i.default{decodeBlock(e){return e}}r.default=n},{"./basedecoder":"FJDe"}],tcId:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));function n(e,t){for(let r=t.length-1;r>=0;r--)e.push(t[r]);return e}function o(e){const t=new Uint16Array(4093),r=new Uint8Array(4093);for(let e=0;e<=257;e++)t[e]=4096,r[e]=e;let i=258,o=9,s=0;function a(){i=258,o=9}function l(e){const t=function(e,t,r){const i=t%8,n=Math.floor(t/8),o=8-i,s=t+r-8*(n+1);let a=8*(n+2)-(t+r);const l=8*(n+2)-t;if(a=Math.max(0,a),n>=e.length)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),257;let c=e[n]&2**(8-i)-1,f=c<<=r-o;if(n+1<e.length){let t=e[n+1]>>>a;f+=t<<=Math.max(0,r-l)}if(s>8&&n+2<e.length){const i=8*(n+3)-(t+r);f+=e[n+2]>>>i}return f}(e,s,o);return s+=o,t}function c(e,n){return r[i]=n,t[i]=e,++i-1}function f(e){const i=[];for(let n=e;4096!==n;n=t[n])i.push(r[n]);return i}const u=[];a();const h=new Uint8Array(e);let d,p=l(h);for(;257!==p;){if(256===p){for(a(),p=l(h);256===p;)p=l(h);if(257===p)break;if(p>256)throw new Error("corrupted code at scanline "+p);n(u,f(p)),d=p}else if(p<i){const e=f(p);n(u,e),c(d,e[e.length-1]),d=p}else{const e=f(d);if(!e)throw new Error(`Bogus entry. Not in dictionary, ${d} / ${i}, position: ${s}`);n(u,e),u.push(e[e.length-1]),c(d,e[e.length-1]),d=p}i+1>=2**o&&(12===o?d=void 0:o++),p=l(h)}return new Uint8Array(u)}class s extends i.default{decodeBlock(e){return o(e).buffer}}r.default=s},{"./basedecoder":"FJDe"}],J7kk:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));const n=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),o=4017,s=799,a=3406,l=2276,c=1567,f=3784,u=5793,h=2896;function d(e,t){let r=0;const i=[];let n=16;for(;n>0&&!e[n-1];)--n;i.push({children:[],index:0});let o,s=i[0];for(let a=0;a<n;a++){for(let n=0;n<e[a];n++){for((s=i.pop()).children[s.index]=t[r];s.index>0;)s=i.pop();for(s.index++,i.push(s);i.length<=a;)i.push(o={children:[],index:0}),s.children[s.index]=o.children,s=o;r++}a+1<n&&(i.push(o={children:[],index:0}),s.children[s.index]=o.children,s=o)}return i[0].children}function p(e,t,r,i,o,s,a,l,c){const{mcusPerLine:f,progressive:u}=r,h=t;let d=t,p=0,g=0;function y(){if(g>0)return p>>--g&1;if(255===(p=e[d++])){const t=e[d++];if(t)throw new Error("unexpected marker: "+(p<<8|t).toString(16))}return g=7,p>>>7}function m(e){let t,r=e;for(;null!==(t=y());){if("number"==typeof(r=r[t]))return r;if("object"!=typeof r)throw new Error("invalid huffman sequence")}return null}function w(e){let t=e,r=0;for(;t>0;){const e=y();if(null===e)return;r=r<<1|e,--t}return r}function b(e){const t=w(e);return t>=1<<e-1?t:t+(-1<<e)+1}let T,P=0,S=0;function I(e,t,r,i,n){const o=r%f,s=(r/f|0)*e.v+i,a=o*e.h+n;t(e,e.blocks[s][a])}function D(e,t,r){const i=r/e.blocksPerLine|0,n=r%e.blocksPerLine;t(e,e.blocks[i][n])}const A=i.length;let O,v,M,G,E,C;C=u?0===s?0===l?function(e,t){const r=m(e.huffmanTableDC),i=0===r?0:b(r)<<c;e.pred+=i,t[0]=e.pred}:function(e,t){t[0]|=y()<<c}:0===l?function(e,t){if(P>0)return void P--;let r=s;const i=a;for(;r<=i;){const i=m(e.huffmanTableAC),o=15&i,s=i>>4;if(0===o){if(s<15){P=w(s)+(1<<s)-1;break}r+=16}else t[n[r+=s]]=b(o)*(1<<c),r++}}:function(e,t){let r=s;const i=a;let o=0;for(;r<=i;){const i=n[r],s=t[i]<0?-1:1;switch(S){case 0:{const t=m(e.huffmanTableAC),r=15&t;if(o=t>>4,0===r)o<15?(P=w(o)+(1<<o),S=4):(o=16,S=1);else{if(1!==r)throw new Error("invalid ACn encoding");T=b(r),S=o?2:3}continue}case 1:case 2:t[i]?t[i]+=(y()<<c)*s:0==--o&&(S=2===S?3:0);break;case 3:t[i]?t[i]+=(y()<<c)*s:(t[i]=T<<c,S=0);break;case 4:t[i]&&(t[i]+=(y()<<c)*s)}r++}4===S&&0==--P&&(S=0)}:function(e,t){const r=m(e.huffmanTableDC),i=0===r?0:b(r);e.pred+=i,t[0]=e.pred;let o=1;for(;o<64;){const r=m(e.huffmanTableAC),i=15&r,s=r>>4;if(0===i){if(s<15)break;o+=16}else t[n[o+=s]]=b(i),o++}};let k,F,_=0;F=1===A?i[0].blocksPerLine*i[0].blocksPerColumn:f*r.mcusPerColumn;const U=o||F;for(;_<F;){for(v=0;v<A;v++)i[v].pred=0;if(P=0,1===A)for(O=i[0],E=0;E<U;E++)D(O,C,_),_++;else for(E=0;E<U;E++){for(v=0;v<A;v++){O=i[v];const{h:e,v:t}=O;for(M=0;M<t;M++)for(G=0;G<e;G++)I(O,C,_,M,G)}if(++_===F)break}if(g=0,(k=e[d]<<8|e[d+1])<65280)throw new Error("marker was not found");if(!(k>=65488&&k<=65495))break;d+=2}return d-h}function g(e,t){const r=[],{blocksPerLine:i,blocksPerColumn:n}=t,d=i<<3,p=new Int32Array(64),g=new Uint8Array(64);function y(e,r,i){const n=t.quantizationTable;let d,p,g,y,m,w,b,T,P;const S=i;let I;for(I=0;I<64;I++)S[I]=e[I]*n[I];for(I=0;I<8;++I){const e=8*I;0!==S[1+e]||0!==S[2+e]||0!==S[3+e]||0!==S[4+e]||0!==S[5+e]||0!==S[6+e]||0!==S[7+e]?(d=u*S[0+e]+128>>8,p=u*S[4+e]+128>>8,g=S[2+e],y=S[6+e],m=h*(S[1+e]-S[7+e])+128>>8,T=h*(S[1+e]+S[7+e])+128>>8,w=S[3+e]<<4,b=S[5+e]<<4,P=d-p+1>>1,d=d+p+1>>1,p=P,P=g*f+y*c+128>>8,g=g*c-y*f+128>>8,y=P,P=m-b+1>>1,m=m+b+1>>1,b=P,P=T+w+1>>1,w=T-w+1>>1,T=P,P=d-y+1>>1,d=d+y+1>>1,y=P,P=p-g+1>>1,p=p+g+1>>1,g=P,P=m*l+T*a+2048>>12,m=m*a-T*l+2048>>12,T=P,P=w*s+b*o+2048>>12,w=w*o-b*s+2048>>12,b=P,S[0+e]=d+T,S[7+e]=d-T,S[1+e]=p+b,S[6+e]=p-b,S[2+e]=g+w,S[5+e]=g-w,S[3+e]=y+m,S[4+e]=y-m):(P=u*S[0+e]+512>>10,S[0+e]=P,S[1+e]=P,S[2+e]=P,S[3+e]=P,S[4+e]=P,S[5+e]=P,S[6+e]=P,S[7+e]=P)}for(I=0;I<8;++I){const e=I;0!==S[8+e]||0!==S[16+e]||0!==S[24+e]||0!==S[32+e]||0!==S[40+e]||0!==S[48+e]||0!==S[56+e]?(d=u*S[0+e]+2048>>12,p=u*S[32+e]+2048>>12,g=S[16+e],y=S[48+e],m=h*(S[8+e]-S[56+e])+2048>>12,T=h*(S[8+e]+S[56+e])+2048>>12,w=S[24+e],b=S[40+e],P=d-p+1>>1,d=d+p+1>>1,p=P,P=g*f+y*c+2048>>12,g=g*c-y*f+2048>>12,y=P,P=m-b+1>>1,m=m+b+1>>1,b=P,P=T+w+1>>1,w=T-w+1>>1,T=P,P=d-y+1>>1,d=d+y+1>>1,y=P,P=p-g+1>>1,p=p+g+1>>1,g=P,P=m*l+T*a+2048>>12,m=m*a-T*l+2048>>12,T=P,P=w*s+b*o+2048>>12,w=w*o-b*s+2048>>12,b=P,S[0+e]=d+T,S[56+e]=d-T,S[8+e]=p+b,S[48+e]=p-b,S[16+e]=g+w,S[40+e]=g-w,S[24+e]=y+m,S[32+e]=y-m):(P=u*i[I+0]+8192>>14,S[0+e]=P,S[8+e]=P,S[16+e]=P,S[24+e]=P,S[32+e]=P,S[40+e]=P,S[48+e]=P,S[56+e]=P)}for(I=0;I<64;++I){const e=128+(S[I]+8>>4);r[I]=e<0?0:e>255?255:e}}for(let e=0;e<n;e++){const n=e<<3;for(let e=0;e<8;e++)r.push(new Uint8Array(d));for(let o=0;o<i;o++){y(t.blocks[e][o],g,p);let i=0;const s=o<<3;for(let e=0;e<8;e++){const t=r[n+e];for(let e=0;e<8;e++)t[s+e]=g[i++]}}}return r}class y{constructor(){this.jfif=null,this.adobe=null,this.quantizationTables=[],this.huffmanTablesAC=[],this.huffmanTablesDC=[],this.resetFrames()}resetFrames(){this.frames=[]}parse(e){let t=0;function r(){const r=e[t]<<8|e[t+1];return t+=2,r}function i(){const i=r(),n=e.subarray(t,t+i-2);return t+=n.length,n}function o(e){let t,r,i=0,n=0;for(r in e.components)e.components.hasOwnProperty(r)&&(i<(t=e.components[r]).h&&(i=t.h),n<t.v&&(n=t.v));const o=Math.ceil(e.samplesPerLine/8/i),s=Math.ceil(e.scanLines/8/n);for(r in e.components)if(e.components.hasOwnProperty(r)){t=e.components[r];const a=Math.ceil(Math.ceil(e.samplesPerLine/8)*t.h/i),l=Math.ceil(Math.ceil(e.scanLines/8)*t.v/n),c=o*t.h,f=s*t.v,u=[];for(let e=0;e<f;e++){const e=[];for(let t=0;t<c;t++)e.push(new Int32Array(64));u.push(e)}t.blocksPerLine=a,t.blocksPerColumn=l,t.blocks=u}e.maxH=i,e.maxV=n,e.mcusPerLine=o,e.mcusPerColumn=s}let s=r();if(65496!==s)throw new Error("SOI not found");for(s=r();65497!==s;){switch(s){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:{const e=i();65504===s&&74===e[0]&&70===e[1]&&73===e[2]&&70===e[3]&&0===e[4]&&(this.jfif={version:{major:e[5],minor:e[6]},densityUnits:e[7],xDensity:e[8]<<8|e[9],yDensity:e[10]<<8|e[11],thumbWidth:e[12],thumbHeight:e[13],thumbData:e.subarray(14,14+3*e[12]*e[13])}),65518===s&&65===e[0]&&100===e[1]&&111===e[2]&&98===e[3]&&101===e[4]&&0===e[5]&&(this.adobe={version:e[6],flags0:e[7]<<8|e[8],flags1:e[9]<<8|e[10],transformCode:e[11]});break}case 65499:{const i=r()+t-2;for(;t<i;){const i=e[t++],o=new Int32Array(64);if(i>>4==0)for(let r=0;r<64;r++)o[n[r]]=e[t++];else{if(i>>4!=1)throw new Error("DQT: invalid table spec");for(let e=0;e<64;e++)o[n[e]]=r()}this.quantizationTables[15&i]=o}break}case 65472:case 65473:case 65474:{r();const i={extended:65473===s,progressive:65474===s,precision:e[t++],scanLines:r(),samplesPerLine:r(),components:{},componentsOrder:[]},n=e[t++];let a;for(let r=0;r<n;r++){a=e[t];const r=e[t+1]>>4,n=15&e[t+1],o=e[t+2];i.componentsOrder.push(a),i.components[a]={h:r,v:n,quantizationIdx:o},t+=3}o(i),this.frames.push(i);break}case 65476:{const i=r();for(let r=2;r<i;){const i=e[t++],n=new Uint8Array(16);let o=0;for(let r=0;r<16;r++,t++)n[r]=e[t],o+=n[r];const s=new Uint8Array(o);for(let r=0;r<o;r++,t++)s[r]=e[t];r+=17+o,i>>4==0?this.huffmanTablesDC[15&i]=d(n,s):this.huffmanTablesAC[15&i]=d(n,s)}break}case 65501:r(),this.resetInterval=r();break;case 65498:{r();const i=e[t++],n=[],o=this.frames[0];for(let r=0;r<i;r++){const r=o.components[e[t++]],i=e[t++];r.huffmanTableDC=this.huffmanTablesDC[i>>4],r.huffmanTableAC=this.huffmanTablesAC[15&i],n.push(r)}const s=e[t++],a=e[t++],l=e[t++],c=p(e,t,o,n,this.resetInterval,s,a,l>>4,15&l);t+=c;break}case 65535:255!==e[t]&&t--;break;default:if(255===e[t-3]&&e[t-2]>=192&&e[t-2]<=254){t-=3;break}throw new Error("unknown JPEG marker "+s.toString(16))}s=r()}}getResult(){const{frames:e}=this;if(0===this.frames.length)throw new Error("no frames were decoded");this.frames.length>1&&console.warn("more than one frame is not supported");for(let e=0;e<this.frames.length;e++){const t=this.frames[e].components;for(const e of Object.keys(t))t[e].quantizationTable=this.quantizationTables[t[e].quantizationIdx],delete t[e].quantizationIdx}const t=e[0],{components:r,componentsOrder:i}=t,n=[],o=t.samplesPerLine,s=t.scanLines;for(let e=0;e<i.length;e++){const o=r[i[e]];n.push({lines:g(0,o),scaleX:o.h/t.maxH,scaleY:o.v/t.maxV})}const a=new Uint8Array(o*s*n.length);let l=0;for(let e=0;e<s;++e)for(let t=0;t<o;++t)for(let r=0;r<n.length;++r){const i=n[r];a[l]=i.lines[0|e*i.scaleY][0|t*i.scaleX],++l}return a}}class m extends i.default{constructor(e){super(),this.reader=new y,e.JPEGTables&&this.reader.parse(e.JPEGTables)}decodeBlock(e){return this.reader.resetFrames(),this.reader.parse(new Uint8Array(e)),this.reader.getResult().buffer}}r.default=m},{"./basedecoder":"FJDe"}],JAiC:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("pako/lib/inflate"),n=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));class o extends n.default{decodeBlock(e){return(0,i.inflate)(new Uint8Array(e)).buffer}}r.default=o},{"./basedecoder":"FJDe"}],OcPz:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));class n extends i.default{decodeBlock(e){const t=new DataView(e),r=[];for(let i=0;i<e.byteLength;++i){let e=t.getInt8(i);if(e<0){const n=t.getUint8(i+1);e=-e;for(let t=0;t<=e;++t)r.push(n);i+=1}else{for(let n=0;n<=e;++n)r.push(t.getUint8(i+n+1));i+=e+1}}return new Uint8Array(r).buffer}}r.default=n},{"./basedecoder":"FJDe"}],FGCZ:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getDecoder=function(e){switch(e.Compression){case void 0:case 1:return new i.default;case 5:return new n.default;case 6:throw new Error("old style JPEG compression is not supported.");case 7:return new o.default(e);case 8:case 32946:return new s.default;case 32773:return new a.default;default:throw new Error("Unknown compression method identifier: "+e.Compression)}};var i=l(e("./raw")),n=l(e("./lzw")),o=l(e("./jpeg")),s=l(e("./deflate")),a=l(e("./packbits"));function l(e){return e&&e.__esModule?e:{default:e}}},{"./raw":"V9bQ","./lzw":"tcId","./jpeg":"J7kk","./deflate":"JAiC","./packbits":"OcPz"}],OQju:[function(e,t,r){"use strict";function i(e,t,r,i=1){return new(Object.getPrototypeOf(e).constructor)(t*r*i)}function n(e,t,r,n,o){const s=t/n,a=r/o;return e.map(e=>{const l=i(e,n,o);for(let i=0;i<o;++i){const o=Math.min(Math.round(a*i),r-1);for(let r=0;r<n;++r){const a=Math.min(Math.round(s*r),t-1),c=e[o*t+a];l[i*n+r]=c}}return l})}function o(e,t,r){return(1-r)*e+r*t}function s(e,t,r,n,s){const a=t/n,l=r/s;return e.map(e=>{const c=i(e,n,s);for(let i=0;i<s;++i){const s=l*i,f=Math.floor(s),u=Math.min(Math.ceil(s),r-1);for(let r=0;r<n;++r){const l=a*r,h=l%1,d=Math.floor(l),p=Math.min(Math.ceil(l),t-1),g=e[f*t+d],y=e[f*t+p],m=e[u*t+d],w=e[u*t+p],b=o(o(g,y,h),o(m,w,h),s%1);c[i*n+r]=b}}return c})}function a(e,t,r,n,o,s){const a=t/n,l=r/o,c=i(e,n,o,s);for(let i=0;i<o;++i){const o=Math.min(Math.round(l*i),r-1);for(let r=0;r<n;++r){const l=Math.min(Math.round(a*r),t-1);for(let a=0;a<s;++a){const f=e[o*t*s+l*s+a];c[i*n*s+r*s+a]=f}}}return c}function l(e,t,r,n,s,a){const l=t/n,c=r/s,f=i(e,n,s,a);for(let i=0;i<s;++i){const s=c*i,u=Math.floor(s),h=Math.min(Math.ceil(s),r-1);for(let r=0;r<n;++r){const c=l*r,d=c%1,p=Math.floor(c),g=Math.min(Math.ceil(c),t-1);for(let l=0;l<a;++l){const c=e[u*t*a+p*a+l],y=e[u*t*a+g*a+l],m=e[h*t*a+p*a+l],w=e[h*t*a+g*a+l],b=o(o(c,y,d),o(m,w,d),s%1);f[i*n*a+r*a+l]=b}}}return f}Object.defineProperty(r,"__esModule",{value:!0}),r.resampleNearest=n,r.resampleBilinear=s,r.resample=function(e,t,r,i,o,a="nearest"){switch(a.toLowerCase()){case"nearest":return n(e,t,r,i,o);case"bilinear":case"linear":return s(e,t,r,i,o);default:throw new Error(`Unsupported resampling method: \'${a}\'`)}},r.resampleNearestInterleaved=a,r.resampleBilinearInterleaved=l,r.resampleInterleaved=function(e,t,r,i,n,o,s="nearest"){switch(s.toLowerCase()){case"nearest":return a(e,t,r,i,n,o);case"bilinear":case"linear":return l(e,t,r,i,n,o);default:throw new Error(`Unsupported resampling method: \'${s}\'`)}}},{}],eOWo:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("txml")),n=e("./globals"),o=e("./rgb"),s=e("./compression"),a=e("./resample");function l(e,t,r){let i=0;for(let n=t;n<r;++n)i+=e[n];return i}function c(e,t,r){switch(e){case 1:switch(t){case 8:return new Uint8Array(r);case 16:return new Uint16Array(r);case 32:return new Uint32Array(r)}break;case 2:switch(t){case 8:return new Int8Array(r);case 16:return new Int16Array(r);case 32:return new Int32Array(r)}break;case 3:switch(t){case 32:return new Float32Array(r);case 64:return new Float64Array(r)}}throw Error("Unsupported data format/bitsPerSample")}var f=class{constructor(e,t,r,i,n,o){this.fileDirectory=e,this.geoKeys=t,this.dataView=r,this.littleEndian=i,this.tiles=n?{}:null,this.isTiled=!e.StripOffsets;const s=e.PlanarConfiguration;if(this.planarConfiguration=void 0===s?1:s,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.");this.source=o}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return this.fileDirectory.SamplesPerPixel}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:void 0!==this.fileDirectory.RowsPerStrip?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBytesPerPixel(){let e=0;for(let t=0;t<this.fileDirectory.BitsPerSample.length;++t){const r=this.fileDirectory.BitsPerSample[t];if(r%8!=0)throw new Error(`Sample bit-width of ${r} is not supported.`);if(r!==this.fileDirectory.BitsPerSample[0])throw new Error("Differing size of samples in a pixel are not supported.");e+=r}return e/8}getSampleByteSize(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${e} is out of range.`);const t=this.fileDirectory.BitsPerSample[e];if(t%8!=0)throw new Error(`Sample bit-width of ${t} is not supported.`);return t/8}getReaderForSample(e){const t=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,r=this.fileDirectory.BitsPerSample[e];switch(t){case 1:switch(r){case 8:return DataView.prototype.getUint8;case 16:return DataView.prototype.getUint16;case 32:return DataView.prototype.getUint32}break;case 2:switch(r){case 8:return DataView.prototype.getInt8;case 16:return DataView.prototype.getInt16;case 32:return DataView.prototype.getInt32}break;case 3:switch(r){case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}throw Error("Unsupported data format/bitsPerSample")}getArrayForSample(e,t){return c(this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,this.fileDirectory.BitsPerSample[e],t)}async getTileOrStrip(e,t,r,i){const n=Math.ceil(this.getWidth()/this.getTileWidth()),o=Math.ceil(this.getHeight()/this.getTileHeight());let s;const{tiles:a}=this;let l,c;1===this.planarConfiguration?s=t*n+e:2===this.planarConfiguration&&(s=r*n*o+t*n+e),this.isTiled?(l=this.fileDirectory.TileOffsets[s],c=this.fileDirectory.TileByteCounts[s]):(l=this.fileDirectory.StripOffsets[s],c=this.fileDirectory.StripByteCounts[s]);const f=await this.source.fetch(l,c);let u;return null===a?u=i.decode(this.fileDirectory,f):a[s]||(u=i.decode(this.fileDirectory,f),a[s]=u),{x:e,y:t,sample:r,data:await u}}async _readRaster(e,t,r,i,n,o,s,c){const f=this.getTileWidth(),u=this.getTileHeight(),h=Math.max(Math.floor(e[0]/f),0),d=Math.min(Math.ceil(e[2]/f),Math.ceil(this.getWidth()/this.getTileWidth())),p=Math.max(Math.floor(e[1]/u),0),g=Math.min(Math.ceil(e[3]/u),Math.ceil(this.getHeight()/this.getTileHeight())),y=e[2]-e[0];let m=this.getBytesPerPixel();const w=[],b=[];for(let e=0;e<t.length;++e)1===this.planarConfiguration?w.push(l(this.fileDirectory.BitsPerSample,0,t[e])/8):w.push(0),b.push(this.getReaderForSample(t[e]));const T=[],{littleEndian:P}=this;for(let o=p;o<g;++o)for(let s=h;s<d;++s)for(let a=0;a<t.length;++a){const l=a,c=t[a];2===this.planarConfiguration&&(m=this.getSampleByteSize(c));const h=this.getTileOrStrip(s,o,c,n);T.push(h),h.then(n=>{const o=n.data,s=new DataView(o),a=n.y*u,c=n.x*f,h=(n.y+1)*u,d=(n.x+1)*f,p=b[l],g=Math.min(u,u-(h-e[3])),T=Math.min(f,f-(d-e[2]));for(let n=Math.max(0,e[1]-a);n<g;++n)for(let o=Math.max(0,e[0]-c);o<T;++o){const u=(n*f+o)*m,h=p.call(s,u+w[l],P);let d;i?(d=(n+a-e[1])*y*t.length+(o+c-e[0])*t.length+l,r[d]=h):(d=(n+a-e[1])*y+o+c-e[0],r[l][d]=h)}})}if(await Promise.all(T),o&&e[2]-e[0]!==o||s&&e[3]-e[1]!==s){let n;return(n=i?(0,a.resampleInterleaved)(r,e[2]-e[0],e[3]-e[1],o,s,t.length,c):(0,a.resample)(r,e[2]-e[0],e[3]-e[1],o,s,c)).width=o,n.height=s,n}return r.width=o||e[2]-e[0],r.height=s||e[3]-e[1],r}async readRasters({window:e,samples:t=[],interleave:r,pool:i=null,width:n,height:o,resampleMethod:a,fillValue:l}={}){const f=e||[0,0,this.getWidth(),this.getHeight()];if(f[0]>f[2]||f[1]>f[3])throw new Error("Invalid subsets");const u=(f[2]-f[0])*(f[3]-f[1]);if(t&&t.length){for(let e=0;e<t.length;++e)if(t[e]>=this.fileDirectory.SamplesPerPixel)return Promise.reject(new RangeError(`Invalid sample index \'${t[e]}\'.`))}else for(let e=0;e<this.fileDirectory.SamplesPerPixel;++e)t.push(e);let h;if(r)h=c(this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,Math.max.apply(null,this.fileDirectory.BitsPerSample),u*t.length),l&&h.fill(l);else{h=[];for(let e=0;e<t.length;++e){const r=this.getArrayForSample(t[e],u);Array.isArray(l)&&e<l.length?r.fill(l[e]):l&&!Array.isArray(l)&&r.fill(l),h.push(r)}}const d=i||(0,s.getDecoder)(this.fileDirectory);return await this._readRaster(f,t,h,r,d,n,o,a)}async readRGB({window:e,pool:t=null,width:r,height:i,resampleMethod:s,enableAlpha:a=!1}={}){const l=e||[0,0,this.getWidth(),this.getHeight()];if(l[0]>l[2]||l[1]>l[3])throw new Error("Invalid subsets");const c=this.fileDirectory.PhotometricInterpretation;if(c===n.photometricInterpretations.RGB){let o=[0,1,2];if(this.fileDirectory.ExtraSamples!==n.ExtraSamplesValues.Unspecified&&a){o=[];for(let e=0;e<this.fileDirectory.BitsPerSample.length;e+=1)o.push(e)}return this.readRasters({window:e,interleave:!0,samples:o,pool:t,width:r,height:i})}let f;switch(c){case n.photometricInterpretations.WhiteIsZero:case n.photometricInterpretations.BlackIsZero:case n.photometricInterpretations.Palette:f=[0];break;case n.photometricInterpretations.CMYK:f=[0,1,2,3];break;case n.photometricInterpretations.YCbCr:case n.photometricInterpretations.CIELab:f=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const u={window:l,interleave:!0,samples:f,pool:t,width:r,height:i,resampleMethod:s},{fileDirectory:h}=this,d=await this.readRasters(u),p=2**this.fileDirectory.BitsPerSample[0];let g;switch(c){case n.photometricInterpretations.WhiteIsZero:g=(0,o.fromWhiteIsZero)(d,p);break;case n.photometricInterpretations.BlackIsZero:g=(0,o.fromBlackIsZero)(d,p);break;case n.photometricInterpretations.Palette:g=(0,o.fromPalette)(d,h.ColorMap);break;case n.photometricInterpretations.CMYK:g=(0,o.fromCMYK)(d);break;case n.photometricInterpretations.YCbCr:g=(0,o.fromYCbCr)(d);break;case n.photometricInterpretations.CIELab:g=(0,o.fromCIELab)(d);break;default:throw new Error("Unsupported photometric interpretation.")}return g.width=d.width,g.height=d.height,g}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const e=[];for(let t=0;t<this.fileDirectory.ModelTiepoint.length;t+=6)e.push({i:this.fileDirectory.ModelTiepoint[t],j:this.fileDirectory.ModelTiepoint[t+1],k:this.fileDirectory.ModelTiepoint[t+2],x:this.fileDirectory.ModelTiepoint[t+3],y:this.fileDirectory.ModelTiepoint[t+4],z:this.fileDirectory.ModelTiepoint[t+5]});return e}getGDALMetadata(e=null){const t={};if(!this.fileDirectory.GDAL_METADATA)return null;const r=this.fileDirectory.GDAL_METADATA,n=(0,i.default)(r.substring(0,r.length-1));if(!n[0].tagName)throw new Error("Failed to parse GDAL metadata XML.");const o=n[0];if("GDALMetadata"!==o.tagName)throw new Error("Unexpected GDAL metadata XML tag.");let s=o.children.filter(e=>"Item"===e.tagName);e&&(s=s.filter(t=>Number(t.attributes.sample)===e));for(let e=0;e<s.length;++e){const r=s[e];t[r.attributes.name]=r.children[0]}return t}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const e=this.fileDirectory.GDAL_NODATA;return Number(e.substring(0,e.length-1))}getOrigin(){const e=this.fileDirectory.ModelTiepoint,t=this.fileDirectory.ModelTransformation;if(e&&6===e.length)return[e[3],e[4],e[5]];if(t)return[t[3],t[7],t[11]];throw new Error("The image does not have an affine transformation.")}getResolution(e=null){const t=this.fileDirectory.ModelPixelScale,r=this.fileDirectory.ModelTransformation;if(t)return[t[0],-t[1],t[2]];if(r)return[r[0],r[5],r[10]];if(e){const[t,r,i]=e.getResolution();return[t*e.getWidth()/this.getWidth(),r*e.getHeight()/this.getHeight(),i*e.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return 1===this.geoKeys.GTRasterTypeGeoKey}getBoundingBox(){const e=this.getOrigin(),t=this.getResolution(),r=e[0],i=e[1],n=r+t[0]*this.getWidth(),o=i+t[1]*this.getHeight();return[Math.min(r,n),Math.min(i,o),Math.max(r,n),Math.max(i,o)]}};r.default=f},{"./globals":"j27V","./rgb":"fpBl","./compression":"FGCZ","./resample":"OQju"}],dqpX:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=class{constructor(e){this._dataView=new DataView(e)}get buffer(){return this._dataView.buffer}getUint64(e,t){const r=this.getUint32(e,t),i=this.getUint32(e+4,t);return t?r<<32|i:i<<32|r}getInt64(e,t){let r,i;return t?(r=this.getInt32(e,t))<<32|(i=this.getUint32(e+4,t)):(r=this.getUint32(e,t),(i=this.getInt32(e+4,t))<<32|r)}getUint8(e,t){return this._dataView.getUint8(e,t)}getInt8(e,t){return this._dataView.getInt8(e,t)}getUint16(e,t){return this._dataView.getUint16(e,t)}getInt16(e,t){return this._dataView.getInt16(e,t)}getUint32(e,t){return this._dataView.getUint32(e,t)}getInt32(e,t){return this._dataView.getInt32(e,t)}getFloat32(e,t){return this._dataView.getFloat32(e,t)}getFloat64(e,t){return this._dataView.getFloat64(e,t)}}},{}],dGLV:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=class{constructor(e,t,r,i){this._dataView=new DataView(e),this._sliceOffset=t,this._littleEndian=r,this._bigTiff=i}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(e,t){return this.sliceOffset<=e&&this.sliceTop>=e+t}readUint8(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}readInt8(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}readUint16(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}readInt16(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}readUint32(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}readInt32(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}readFloat32(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}readFloat64(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}readUint64(e){const t=this.readUint32(e),r=this.readUint32(e+4);let i;if(this._littleEndian){if(i=t+2**32*r,!Number.isSafeInteger(i))throw new Error(i+" exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return i}if(i=2**32*t+r,!Number.isSafeInteger(i))throw new Error(i+" exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return i}readInt64(e){let t,r;if(this._littleEndian){if(t=this.readInt32(e),r=this.readUint32(e+4),combined=t+2**32*r,!Number.isSafeInteger(combined))throw new Error(combined+" exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return combined}if(t=this.readUint32(e-this._sliceOffset),r=this.readInt32(e-this._sliceOffset+4),combined=2**32*t+r,!Number.isSafeInteger(combined))throw new Error(combined+" exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return combined}readOffset(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}},{}],dHPO:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("threads/register");var i=e("threads");const n="undefined"!=typeof navigator?navigator.hardwareConcurrency:null;var o=class{constructor(e=n){const t=new Worker("/decoder.worker.7cb947d7.js");this.pool=(0,i.Pool)(()=>(0,i.spawn)(t),e)}async decode(e,t){return new Promise((r,i)=>{this.pool.queue(async n=>{try{const i=await n(e,t);r(i)}catch(e){i(e)}})})}destroy(){this.pool.terminate(!0)}};r.default=o},{"./decoder.worker.js":[["decoder.worker.7cb947d7.js","LHx9"],"decoder.worker.7cb947d7.js.map","LHx9"]}],cUx7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.makeFetchSource=f,r.makeXHRSource=u,r.makeHttpSource=h,r.makeRemoteSource=function(e,t){const{forceXHR:r}=t;if("function"==typeof fetch&&!r)return f(e,t);if("undefined"!=typeof XMLHttpRequest)return u(e,t);if(o.default.get)return h(e,t);throw new Error("No remote source available")},r.makeBufferSource=function(e){return{fetch:async(t,r)=>e.slice(t,t+r)}},r.makeFileSource=function(e){const t=p(e,"r");return{async fetch(e,r){const n=await t,{buffer:o}=await g(n,i.Buffer.alloc(r),0,r,e);return o.buffer},async close(){const e=await t;return await d(e)}}},r.makeFileReaderSource=function(e){return{fetch:async(t,r)=>new Promise((i,n)=>{const o=e.slice(t,t+r),s=new FileReader;s.onload=e=>i(e.target.result),s.onerror=n,s.readAsArrayBuffer(o)})}};var i=e("buffer"),n=e("fs"),o=l(e("http")),s=l(e("https")),a=l(e("url"));function l(e){return e&&e.__esModule?e:{default:e}}class c{constructor(e,{blockSize:t=65536}={}){this.retrievalFunction=e,this.blockSize=t,this.blockRequests=new Map,this.blocks=new Map,this.blockIdsAwaitingRequest=null}async fetch(e,t,r=!1){const i=e+t,n=[],o=[],s=[];for(let t=Math.floor(e/this.blockSize)*this.blockSize;t<i;t+=this.blockSize){const e=Math.floor(t/this.blockSize);this.blocks.has(e)||this.blockRequests.has(e)||o.push(e),this.blockRequests.has(e)&&s.push(this.blockRequests.get(e)),n.push(e)}if(this.blockIdsAwaitingRequest)for(let e=0;e<o.length;++e){const t=o[e];this.blockIdsAwaitingRequest.add(t)}else this.blockIdsAwaitingRequest=new Set(o);if(r||await async function(e){return new Promise(t=>setTimeout(t,e))}(),this.blockIdsAwaitingRequest){const e=function(e){if(0===e.length)return[];const t=[];let r=[];t.push(r);for(let i=0;i<e.length;++i)0===i||e[i]===e[i-1]+1?r.push(e[i]):(r=[e[i]],t.push(r));return t}(Array.from(this.blockIdsAwaitingRequest).sort());for(const t of e){const e=this.requestData(t[0]*this.blockSize,t.length*this.blockSize);for(let r=0;r<t.length;++r){const i=t[r];this.blockRequests.set(i,(async()=>{const t=await e,n=r*this.blockSize,o=Math.min(n+this.blockSize,t.data.byteLength),s=t.data.slice(n,o);this.blockRequests.delete(i),this.blocks.set(i,{data:s,offset:t.offset+n,length:s.byteLength,top:t.offset+o})})())}}this.blockIdsAwaitingRequest=null}const a=[];for(const e of o)this.blockRequests.has(e)&&a.push(this.blockRequests.get(e));return await Promise.all(a),await Promise.all(s),function(e,t,r){const i=t+r,n=new ArrayBuffer(r),o=new Uint8Array(n);for(const r of e){const e=r.offset-t,n=r.top-i;let s,a=0,l=0;e<0?a=-e:e>0&&(l=e),n<0?s=r.length-a:n>0&&(s=i-r.offset-a);const c=new Uint8Array(r.data,a,s);o.set(c,l)}return n}(n.map(e=>this.blocks.get(e)),e,t)}async requestData(e,t){const r=await this.retrievalFunction(e,t);return r.length?r.length!==r.data.byteLength&&(r.data=r.data.slice(0,r.length)):r.length=r.data.byteLength,r.top=r.offset+r.length,r}}function f(e,{headers:t={},blockSize:r}={}){return new c(async(r,i)=>{const n=await fetch(e,{headers:{...t,Range:`bytes=${r}-${r+i-1}`}});if(n.ok){if(206===n.status)return{data:n.arrayBuffer?await n.arrayBuffer():(await n.buffer()).buffer,offset:r,length:i};{const e=n.arrayBuffer?await n.arrayBuffer():(await n.buffer()).buffer;return{data:e,offset:0,length:e.byteLength}}}throw new Error("Error fetching data.")},{blockSize:r})}function u(e,{headers:t={},blockSize:r}={}){return new c(async(r,i)=>new Promise((n,o)=>{const s=new XMLHttpRequest;s.open("GET",e),s.responseType="arraybuffer";const a={...t,Range:`bytes=${r}-${r+i-1}`};for(const[e,t]of Object.entries(a))s.setRequestHeader(e,t);s.onload=()=>{const e=s.response;206===s.status?n({data:e,offset:r,length:i}):n({data:e,offset:0,length:e.byteLength})},s.onerror=o,s.send()}),{blockSize:r})}function h(e,{headers:t={},blockSize:r}={}){return new c(async(r,n)=>new Promise((l,c)=>{const f=a.default.parse(e);("http:"===f.protocol?o.default:s.default).get({...f,headers:{...t,Range:`bytes=${r}-${r+n-1}`}},e=>{const t=[];e.on("data",e=>{t.push(e)}),e.on("end",()=>{const e=i.Buffer.concat(t).buffer;l({data:e,offset:r,length:e.byteLength})})}).on("error",c)}),{blockSize:r})}function d(e){return new Promise((t,r)=>{(0,n.close)(e,e=>{e?r(e):t()})})}function p(e,t,r){return new Promise((i,o)=>{(0,n.open)(e,t,r,(e,t)=>{e?o(e):i(t)})})}function g(...e){return new Promise((t,r)=>{(0,n.read)(...e,(e,i,n)=>{e?r(e):t({bytesRead:i,buffer:n})})})}},{}],FOZT:[function(e,t,r){"use strict";function i(e){const t=[],{length:r}=e;for(let i=0;i<r;i++)t.push(e[i]);return t}Object.defineProperty(r,"__esModule",{value:!0}),r.assign=function(e,t){for(const r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},r.chunk=function(e,t){const r=[],i=e.length;for(let n=0;n<i;n+=t){const i=[];for(let r=n;r<n+t;r++)i.push(e[r]);r.push(i)}return r},r.endsWith=function(e,t){return!(e.length<t.length)&&e.substr(e.length-t.length)===t},r.forEach=function(e,t){const{length:r}=e;for(let i=0;i<r;i++)t(e[i],i)},r.invert=function(e){const t={};for(const r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t},r.range=function(e){const t=[];for(let r=0;r<e;r++)t.push(r);return t},r.times=function(e,t){const r=[];for(let i=0;i<e;i++)r.push(t(i));return r},r.toArray=i,r.toArrayRecursively=function e(t){return t.length?i(t).map(e):t}},{}],BGyE:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.writeGeotiff=function(e,t){let r,o,s,l;"number"==typeof e[0]?(r=t.height||t.ImageLength,s=t.width||t.ImageWidth,o=e.length/(r*s),l=e):(o=e.length,r=e[0].length,s=e[0][0].length,l=[],(0,n.times)(r,t=>{(0,n.times)(s,r=>{(0,n.times)(o,i=>{l.push(e[i][t][r])})})})),t.ImageLength=r,delete t.height,t.ImageWidth=s,delete t.width,t.BitsPerSample||(t.BitsPerSample=(0,n.times)(o,()=>8)),d.forEach(e=>{const r=e[0];if(!t[r]){const i=e[1];t[r]=i}}),t.PhotometricInterpretation||(t.PhotometricInterpretation=3===t.BitsPerSample.length?2:1),t.SamplesPerPixel||(t.SamplesPerPixel=[o]),t.StripByteCounts||(t.StripByteCounts=[o*r*s]),t.ModelPixelScale||(t.ModelPixelScale=[360/s,180/r,0]),t.SampleFormat||(t.SampleFormat=(0,n.times)(o,()=>1));const c=Object.keys(t).filter(e=>(0,n.endsWith)(e,"GeoKey")).sort((e,t)=>a[e]-a[t]);if(!t.GeoKeyDirectory){const e=[1,1,0,c.length];c.forEach(r=>{const n=Number(a[r]);let o,s,l;e.push(n),"SHORT"===i.fieldTagTypes[n]?(o=1,s=0,l=t[r]):"GeogCitationGeoKey"===r?(o=t.GeoAsciiParams.length,s=Number(a.GeoAsciiParams),l=0):console.log("[geotiff.js] couldn\'t get TIFFTagLocation for "+r),e.push(s),e.push(o),e.push(l)}),t.GeoKeyDirectory=e}for(const e in c)c.hasOwnProperty(e)&&delete t[e];["Compression","ExtraSamples","GeographicTypeGeoKey","GTModelTypeGeoKey","GTRasterTypeGeoKey","ImageLength","ImageWidth","PhotometricInterpretation","PlanarConfiguration","ResolutionUnit","SamplesPerPixel","XPosition","YPosition"].forEach(e=>{t[e]&&(t[e]=(e=>Array.isArray(e)?e:[e])(t[e]))});const f=(e=>{const t={};for(const r in e)"StripOffsets"!==r&&(a[r]||console.error(r,"not in name2code:",Object.keys(a)),t[a[r]]=e[r]);return t})(t);return h(l,s,r,f)};var i=e("./globals"),n=e("./utils");const o=(0,n.invert)(i.fieldTagNames),s=(0,n.invert)(i.geoKeyNames),a={};(0,n.assign)(a,o),(0,n.assign)(a,s);const l=(0,n.invert)(i.fieldTypeNames),c={nextZero:(e,t)=>{let r=t;for(;0!==e[r];)r++;return r},readUshort:(e,t)=>e[t]<<8|e[t+1],readShort:(e,t)=>{const r=c.ui8;return r[0]=e[t+1],r[1]=e[t+0],c.i16[0]},readInt:(e,t)=>{const r=c.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],c.i32[0]},readUint:(e,t)=>{const r=c.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],c.ui32[0]},readASCII:(e,t,r)=>r.map(r=>String.fromCharCode(e[t+r])).join(""),readFloat:(e,t)=>{const r=c.ui8;return(0,n.times)(4,i=>{r[i]=e[t+3-i]}),c.fl32[0]},readDouble:(e,t)=>{const r=c.ui8;return(0,n.times)(8,i=>{r[i]=e[t+7-i]}),c.fl64[0]},writeUshort:(e,t,r)=>{e[t]=r>>8&255,e[t+1]=255&r},writeUint:(e,t,r)=>{e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r>>0&255},writeASCII:(e,t,r)=>{(0,n.times)(r.length,i=>{e[t+i]=r.charCodeAt(i)})},ui8:new Uint8Array(8)};c.fl64=new Float64Array(c.ui8.buffer),c.writeDouble=(e,t,r)=>{c.fl64[0]=r,(0,n.times)(8,r=>{e[t+r]=c.ui8[7-r]})};const f=(e,t,r,o)=>{let s=r;const a=Object.keys(o).filter(e=>null!=e&&"undefined"!==e);e.writeUshort(t,s,a.length);let c=(s+=2)+12*a.length+4;for(const r of a){let a=null;"number"==typeof r?a=r:"string"==typeof r&&(a=parseInt(r,10));const f=i.fieldTagTypes[a],u=l[f];if(null==f||void 0===f||void 0===f)throw new Error("unknown type of tag: "+a);let h=o[r];if(void 0===h)throw new Error("failed to get value for key "+r);"ASCII"===f&&"string"==typeof h&&!1===(0,n.endsWith)(h,"\\0")&&(h+="\\0");const d=h.length;e.writeUshort(t,s,a),s+=2,e.writeUshort(t,s,u),s+=2,e.writeUint(t,s,d);let p=[-1,1,1,2,4,8,0,0,0,0,0,0,8][u]*d,g=s+=4;p>4&&(e.writeUint(t,s,c),g=c),"ASCII"===f?e.writeASCII(t,g,h):"SHORT"===f?(0,n.times)(d,r=>{e.writeUshort(t,g+2*r,h[r])}):"LONG"===f?(0,n.times)(d,r=>{e.writeUint(t,g+4*r,h[r])}):"RATIONAL"===f?(0,n.times)(d,r=>{e.writeUint(t,g+8*r,Math.round(1e4*h[r])),e.writeUint(t,g+8*r+4,1e4)}):"DOUBLE"===f&&(0,n.times)(d,r=>{e.writeDouble(t,g+8*r,h[r])}),p>4&&(c+=p+=1&p),s+=4}return[s,c]},u=e=>{const t=new Uint8Array(1e3);let r=4;const i=c;t[0]=77,t[1]=77,t[3]=42;let n=8;if(i.writeUint(t,r,n),r+=4,e.forEach((r,o)=>{const s=f(i,t,n,r);n=s[1],o<e.length-1&&i.writeUint(t,s[0],n)}),t.slice)return t.slice(0,n).buffer;const o=new Uint8Array(n);for(let e=0;e<n;e++)o[e]=t[e];return o.buffer},h=(e,t,r,i)=>{if(null==r)throw new Error("you passed into encodeImage a width of type "+r);if(null==t)throw new Error("you passed into encodeImage a width of type "+t);const o={256:[t],257:[r],273:[1e3],278:[r],305:"geotiff.js"};if(i)for(const e in i)i.hasOwnProperty(e)&&(o[e]=i[e]);const s=new Uint8Array(u([o])),a=new Uint8Array(e),l=o[277],c=new Uint8Array(1e3+t*r*l);return(0,n.times)(s.length,e=>{c[e]=s[e]}),(0,n.forEach)(a,(e,t)=>{c[1e3+t]=e}),c.buffer},d=[["Compression",1],["PlanarConfiguration",1],["XPosition",0],["YPosition",0],["ResolutionUnit",1],["ExtraSamples",0],["GeoAsciiParams","WGS 84\\0"],["ModelTiepoint",[0,0,0,-180,90,0]],["GTModelTypeGeoKey",2],["GTRasterTypeGeoKey",1],["GeographicTypeGeoKey",4326],["GeogCitationGeoKey","WGS 84"]]},{"./globals":"j27V","./utils":"FOZT"}],bsJs:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fromUrl=async function(e,t={}){return w.fromSource((0,a.makeRemoteSource)(e,t))},r.fromArrayBuffer=async function(e){return w.fromSource((0,a.makeBufferSource)(e))},r.fromFile=async function(e){return w.fromSource((0,a.makeFileSource)(e))},r.fromBlob=async function(e){return w.fromSource((0,a.makeFileReaderSource)(e))},r.fromUrls=async function(e,t=[],r={}){const i=await w.fromSource((0,a.makeRemoteSource)(e,r)),n=await Promise.all(t.map(e=>w.fromSource((0,a.makeRemoteSource)(e,r))));return new T(i,n)},r.writeArrayBuffer=async function(e,t){return(0,c.writeGeotiff)(e,t)},Object.defineProperty(r,"Pool",{enumerable:!0,get:function(){return s.default}}),r.rgb=r.globals=r.MultiGeoTIFF=r.default=r.GeoTIFF=void 0;var i=d(e("./geotiffimage")),n=d(e("./dataview64")),o=d(e("./dataslice")),s=d(e("./pool")),a=e("./source"),l=h(e("./globals"));r.globals=l;var c=e("./geotiffwriter"),f=h(e("./rgb"));function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function h(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=i?Object.getOwnPropertyDescriptor(e,n):null;o&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n]}return r.default=e,t&&t.set(e,r),r}function d(e){return e&&e.__esModule?e:{default:e}}function p(e){switch(e){case l.fieldTypes.BYTE:case l.fieldTypes.ASCII:case l.fieldTypes.SBYTE:case l.fieldTypes.UNDEFINED:return 1;case l.fieldTypes.SHORT:case l.fieldTypes.SSHORT:return 2;case l.fieldTypes.LONG:case l.fieldTypes.SLONG:case l.fieldTypes.FLOAT:case l.fieldTypes.IFD:return 4;case l.fieldTypes.RATIONAL:case l.fieldTypes.SRATIONAL:case l.fieldTypes.DOUBLE:case l.fieldTypes.LONG8:case l.fieldTypes.SLONG8:case l.fieldTypes.IFD8:return 8;default:throw new RangeError("Invalid field type: "+e)}}function g(e){const t=e.GeoKeyDirectory;if(!t)return null;const r={};for(let i=4;i<=4*t[3];i+=4){const n=l.geoKeyNames[t[i]],o=t[i+1]?l.fieldTagNames[t[i+1]]:null,s=t[i+2],a=t[i+3];let c=null;if(o){if(null==(c=e[o]))throw new Error(`Could not get value of geoKey \'${n}\'.`);"string"==typeof c?c=c.substring(a,a+s-1):c.subarray&&(c=c.subarray(a,a+s-1))}else c=a;r[n]=c}return r}function y(e,t,r,i){let n=null,o=null;const s=p(t);switch(t){case l.fieldTypes.BYTE:case l.fieldTypes.ASCII:case l.fieldTypes.UNDEFINED:n=new Uint8Array(r),o=e.readUint8;break;case l.fieldTypes.SBYTE:n=new Int8Array(r),o=e.readInt8;break;case l.fieldTypes.SHORT:n=new Uint16Array(r),o=e.readUint16;break;case l.fieldTypes.SSHORT:n=new Int16Array(r),o=e.readInt16;break;case l.fieldTypes.LONG:case l.fieldTypes.IFD:n=new Uint32Array(r),o=e.readUint32;break;case l.fieldTypes.SLONG:n=new Int32Array(r),o=e.readInt32;break;case l.fieldTypes.LONG8:case l.fieldTypes.IFD8:n=new Array(r),o=e.readUint64;break;case l.fieldTypes.SLONG8:n=new Array(r),o=e.readInt64;break;case l.fieldTypes.RATIONAL:n=new Uint32Array(2*r),o=e.readUint32;break;case l.fieldTypes.SRATIONAL:n=new Int32Array(2*r),o=e.readInt32;break;case l.fieldTypes.FLOAT:n=new Float32Array(r),o=e.readFloat32;break;case l.fieldTypes.DOUBLE:n=new Float64Array(r),o=e.readFloat64;break;default:throw new RangeError("Invalid field type: "+t)}if(t!==l.fieldTypes.RATIONAL&&t!==l.fieldTypes.SRATIONAL)for(let t=0;t<r;++t)n[t]=o.call(e,i+t*s);else for(let t=0;t<r;t+=2)n[t]=o.call(e,i+t*s),n[t+1]=o.call(e,i+(t*s+4));return t===l.fieldTypes.ASCII?String.fromCharCode.apply(null,n):n}r.rgb=f;class m{async readRasters(e={}){const{window:t,width:r,height:i}=e;let{resX:n,resY:o,bbox:s}=e;const a=await this.getImage();let l=a;const c=await this.getImageCount(),f=a.getBoundingBox();if(t&&s)throw new Error(\'Both "bbox" and "window" passed.\');if(r||i){if(t){const[e,r]=a.getOrigin(),[i,n]=a.getResolution();s=[e+t[0]*i,r+t[1]*n,e+t[2]*i,r+t[3]*n]}const e=s||f;if(r){if(n)throw new Error("Both width and resX passed");n=(e[2]-e[0])/r}if(i){if(o)throw new Error("Both width and resY passed");o=(e[3]-e[1])/i}}if(n||o){const e=[];for(let t=0;t<c;++t){const r=await this.getImage(t),{SubfileType:i,NewSubfileType:n}=r.fileDirectory;(0===t||2===i||1&n)&&e.push(r)}e.sort((e,t)=>e.getWidth()-t.getWidth());for(let t=0;t<e.length;++t){const r=e[t],i=(f[2]-f[0])/r.getWidth(),s=(f[3]-f[1])/r.getHeight();if(l=r,n&&n>i||o&&o>s)break}}let u=t;if(s){const[e,t]=a.getOrigin(),[r,i]=l.getResolution(a);u=[Math.round((s[0]-e)/r),Math.round((s[1]-t)/i),Math.round((s[2]-e)/r),Math.round((s[3]-t)/i)],u=[Math.min(u[0],u[2]),Math.min(u[1],u[3]),Math.max(u[0],u[2]),Math.max(u[1],u[3])]}return l.readRasters({...e,window:u})}}class w extends m{constructor(e,t,r,i,n={}){super(),this.source=e,this.littleEndian=t,this.bigTiff=r,this.firstIFDOffset=i,this.cache=n.cache||!1,this.fileDirectories=null,this.fileDirectoriesParsing=null,this.ghostValues=null}async getSlice(e,t){const r=this.bigTiff?4048:1024;return new o.default(await this.source.fetch(e,void 0!==t?t:r),e,this.littleEndian,this.bigTiff)}async parseFileDirectories(){let e=this.firstIFDOffset;const t=this.bigTiff?8:2,r=this.bigTiff?20:12,i=[];for(;0!==e;){let n=await this.getSlice(e);const o=this.bigTiff?n.readUint64(e):n.readUint16(e),s=o*r+(this.bigTiff?16:6);n.covers(e,s)||(n=await this.getSlice(e,s));const a={};let c=e+(this.bigTiff?8:2);for(let e=0;e<o;c+=r,++e){const e=n.readUint16(c),t=n.readUint16(c+2),r=this.bigTiff?n.readUint64(c+4):n.readUint32(c+4);let i,o;const s=p(t),f=c+(this.bigTiff?12:8);if(s*r<=(this.bigTiff?8:4))i=y(n,t,r,f);else{const e=n.readOffset(f),o=p(t)*r;i=n.covers(e,o)?y(n,t,r,e):y(await this.getSlice(e,o),t,r,e)}o=1===r&&-1===l.arrayFields.indexOf(e)&&t!==l.fieldTypes.RATIONAL&&t!==l.fieldTypes.SRATIONAL?i[0]:i,a[l.fieldTagNames[e]]=o}i.push([a,g(a)]),e=n.readOffset(e+t+r*o)}return i}async getImage(e=0){this.fileDirectories||(this.fileDirectoriesParsing||(this.fileDirectoriesParsing=this.parseFileDirectories()),this.fileDirectories=await this.fileDirectoriesParsing);const t=this.fileDirectories[e];if(!t)throw new RangeError("Invalid image index");return new i.default(t[0],t[1],this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){return this.fileDirectories||(this.fileDirectoriesParsing||(this.fileDirectoriesParsing=this.parseFileDirectories()),this.fileDirectories=await this.fileDirectoriesParsing),this.fileDirectories.length}async getGhostValues(){const e=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const t="GDAL_STRUCTURAL_METADATA_SIZE=",r=t.length+100;let i=await this.getSlice(e,r);if(t===y(i,l.fieldTypes.ASCII,t.length,e)){const t=y(i,l.fieldTypes.ASCII,r,e).split("\\n")[0],n=Number(t.split("=")[1].split(" ")[0])+t.length;n>r&&(i=await this.getSlice(e,n));const o=y(i,l.fieldTypes.ASCII,n,e);this.ghostValues={},o.split("\\n").filter(e=>e.length>0).map(e=>e.split("=")).forEach(([e,t])=>{this.ghostValues[e]=t})}return this.ghostValues}static async fromSource(e,t){const r=await e.fetch(0,1024),i=new n.default(r),o=i.getUint16(0,0);let s;if(18761===o)s=!0;else{if(19789!==o)throw new TypeError("Invalid byte order value.");s=!1}const a=i.getUint16(2,s);let l;if(42===a)l=!1;else{if(43!==a)throw new TypeError("Invalid magic number.");if(l=!0,8!==i.getUint16(4,s))throw new Error("Unsupported offset byte-size.")}const c=l?i.getUint64(8,s):i.getUint32(4,s);return new w(e,s,l,c,t)}close(){return"function"==typeof this.source.close&&this.source.close()}}r.GeoTIFF=w;var b=w;r.default=b;class T extends m{constructor(e,t){super(),this.mainFile=e,this.overviewFiles=t,this.imageFiles=[e].concat(t),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const e=[this.mainFile.parseFileDirectories()].concat(this.overviewFiles.map(e=>e.parseFileDirectories()));return this.fileDirectoriesPerFile=await Promise.all(e),this.fileDirectoriesPerFile}async getImage(e=0){this.fileDirectoriesPerFile||(this.fileDirectoriesPerFileParsing||(this.fileDirectoriesPerFileParsing=this.parseFileDirectoriesPerFile()),this.fileDirectoriesPerFile=await this.fileDirectoriesPerFileParsing);let t=e;for(let e=0;e<this.fileDirectoriesPerFile.length;++e){const r=this.fileDirectoriesPerFile[e];if(t<r.length){const n=this.imageFiles[e];return new i.default(r[t][0],r[t][1],n.dataView,n.littleEndian,n.cache,n.source)}t-=r.length}throw new RangeError("Invalid image index")}async getImageCount(){return this.fileDirectoriesPerFile||(this.fileDirectoriesPerFileParsing||(this.fileDirectoriesPerFileParsing=this.parseFileDirectoriesPerFile()),this.fileDirectoriesPerFile=await this.fileDirectoriesPerFileParsing),this.fileDirectoriesPerFile.reduce((e,t)=>e+t.length,0)}}r.MultiGeoTIFF=T},{"./geotiffimage":"eOWo","./dataview64":"dqpX","./dataslice":"dGLV","./pool":"dHPO","./source":"cUx7","./globals":"j27V","./geotiffwriter":"BGyE","./rgb":"fpBl"}],epB2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("./geotiff");Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return i[e]}})}))},{"./geotiff":"bsJs"}]},{},["epB2"])},function(e,t){function r(e){var t=new Error("Cannot find module \'"+e+"\'");throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=3},function(e,t,r){"use strict";e.exports={countIn1D:function(e){return e.reduce((function(e,t){return void 0===e[t]?e[t]=1:e[t]++,e}),{})},countIn2D:function(e){return e.reduce((function(e,t){return t.forEach((function(t){void 0===e[t]?e[t]=1:e[t]++})),e}),{})},unflatten:function(e,t){for(var r=t.height,i=t.width,n=[],o=0;o<r;o++){var s=o*i,a=s+i;n.push(e.slice(s,a))}return n}}}]);',null)}},function(e,t,r){"use strict";var i=window.URL||window.webkitURL;e.exports=function(e,t){try{try{var r;try{(r=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(e),r=r.getBlob()}catch(t){r=new Blob([e])}return new Worker(i.createObjectURL(r))}catch(t){return new Worker("data:application/javascript,"+encodeURIComponent(e))}}catch(e){if(!t)throw Error("Inline worker is not supported");return new Worker(t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],i=!0,n=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(e){n=!0,o=e}finally{try{!i&&a.return&&a.return()}finally{if(n)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function(e,t){return new Promise((function(r,l){try{t&&console.log("starting parseData with",e),t&&console.log("\tGeoTIFF:","undefined"==typeof GeoTIFF?"undefined":n(GeoTIFF));var c={},f=void 0,u=void 0;if("object"===e.rasterType)c.values=e.data,c.height=f=e.metadata.height||c.values[0].length,c.width=u=e.metadata.width||c.values[0][0].length,c.pixelHeight=e.metadata.pixelHeight,c.pixelWidth=e.metadata.pixelWidth,c.projection=e.metadata.projection,c.xmin=e.metadata.xmin,c.ymax=e.metadata.ymax,c.noDataValue=e.metadata.noDataValue,c.numberOfRasters=c.values.length,c.xmax=c.xmin+c.width*c.pixelWidth,c.ymin=c.ymax-c.height*c.pixelHeight,c._data=null,r(a(c));else if("geotiff"===e.rasterType){c._data=e.data;var h=o.fromArrayBuffer;"url"===e.sourceType&&(h=o.fromUrl),t&&console.log("data.rasterType is geotiff"),r(h(e.data).then((function(r){return t&&console.log("geotiff:",r),r.getImage().then((function(r){t&&console.log("image:",r);var n=r.fileDirectory,o=r.getGeoKeys(),l=o.GeographicTypeGeoKey,h=o.ProjectedCSTypeGeoKey;c.projection=l||h,t&&console.log("projection:",c.projection),c.height=f=r.getHeight(),t&&console.log("result.height:",c.height),c.width=u=r.getWidth(),t&&console.log("result.width:",c.width);var d=r.getResolution(),p=i(d,2),g=p[0],y=p[1];c.pixelHeight=Math.abs(y),c.pixelWidth=Math.abs(g);var m=r.getOrigin(),w=i(m,2),b=w[0],T=w[1];return c.xmin=b,c.xmax=c.xmin+u*c.pixelWidth,c.ymax=T,c.ymin=c.ymax-f*c.pixelHeight,c.noDataValue=n.GDAL_NODATA?parseFloat(n.GDAL_NODATA):null,c.numberOfRasters=n.SamplesPerPixel,"url"!==e.sourceType?r.readRasters().then((function(e){return c.values=e.map((function(e){return(0,s.unflatten)(e,{height:f,width:u})})),a(c)})):c}))})))}}catch(e){l(e),console.error("[georaster] error parsing georaster:",e)}}))};var o=r(0),s=r(1);function a(e,t){var r=e.noDataValue,i=e.height,n=e.width;return new Promise((function(o,s){e.maxs=[],e.mins=[],e.ranges=[];for(var a=void 0,l=void 0,c=0;c<e.numberOfRasters;c++){var f=e.values[c];t&&console.log("[georaster] rows:",f);for(var u=0;u<i;u++)for(var h=f[u],d=0;d<n;d++){var p=h[d];p==r||isNaN(p)||(void 0===l||p<l?l=p:(void 0===a||p>a)&&(a=p))}e.maxs.push(a),e.mins.push(l),e.ranges.push(a-l)}o(e)}))}},function(e,t){function r(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=8},function(e,t,r){"use strict";function i(e,t){if("undefined"==typeof ImageData)throw"toCanvas is not supported in your environment";{const r=document.createElement("CANVAS"),i=t&&t.height?Math.min(e.height,t.height):Math.min(e.height,100),n=t&&t.width?Math.min(e.width,t.width):Math.min(e.width,100);r.height=i,r.width=n,r.style.minHeight="200px",r.style.minWidth="400px",r.style.maxWidth="100%";const o=r.getContext("2d"),s=function(e,t,r){if(e.values){const{noDataValue:i,mins:n,ranges:o,values:s}=e,a=s.length,l=e.width/t,c=e.height/r,f=new Uint8ClampedArray(t*r*4);for(let e=0;e<r;e++)for(let r=0;r<t;r++){const u=Math.round(e*c),h=Math.round(r*l),d=s.map(e=>{try{return e[u][h]}catch(e){console.error(e)}});if(d.every(e=>void 0!==e&&e!==i)){const i=e*(4*t)+4*r;if(1===a){const e=Math.round(d[0]),t=Math.round((e-n[0])/o[0]*255);f[i]=t,f[i+1]=t,f[i+2]=t,f[i+3]=255}else if(3===a)try{const[e,t,r]=d;f[i]=e,f[i+1]=t,f[i+2]=r,f[i+3]=255}catch(e){console.error(e)}else if(4===a)try{const[e,t,r,n]=d;f[i]=e,f[i+1]=t,f[i+2]=r,f[i+3]=n}catch(e){console.error(e)}}}return new ImageData(f,t,r)}}(e,n,i);return o.putImageData(s,0,0),r}}r.r(t),r.d(t,"default",(function(){return i}))}])}));